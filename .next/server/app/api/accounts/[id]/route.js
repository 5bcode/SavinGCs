"use strict";(()=>{var e={};e.id=886,e.ids=[886],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},1017:e=>{e.exports=require("path")},3903:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>x,patchFetch:()=>_,requestAsyncStorage:()=>E,routeModule:()=>d,serverHooks:()=>R,staticGenerationAsyncStorage:()=>w});var r={};a.r(r),a.d(r,{DELETE:()=>l,GET:()=>i,PATCH:()=>p});var n=a(9303),s=a(8716),o=a(670),c=a(7070),u=a(4677);async function i(e,t){let{id:a}=await t.params;try{let e=(await u.wp.execute({sql:`SELECT a.*, sp.name as pot_name, sp.color as pot_color
                  FROM accounts a
                  JOIN savings_pots sp ON sp.id = a.pot_id
                  WHERE a.id = ?`,args:[a]})).rows[0];if(!e)return c.NextResponse.json({error:"Account not found"},{status:404});let t=await u.wp.execute({sql:`SELECT balance, recorded_date, created_at
                  FROM balance_history
                  WHERE account_id = ?
                  ORDER BY recorded_date DESC, created_at DESC
                  LIMIT 50`,args:[a]}),r=await u.wp.execute({sql:"SELECT COUNT(*) as count FROM transactions WHERE account_id = ?",args:[a]}),n=Number(r.rows[0].count);return c.NextResponse.json({account:e,history:t.rows,transactionCount:n})}catch(e){return console.error("Error fetching account:",e),c.NextResponse.json({error:"Failed to fetch account"},{status:500})}}async function p(e,t){let{id:a}=await t.params;try{let{accountName:t,accountType:r,owner:n,currentBalance:s}=await e.json(),o=(await u.wp.execute({sql:"SELECT * FROM accounts WHERE id = ?",args:[a]})).rows[0];if(!o)return c.NextResponse.json({error:"Account not found"},{status:404});let i=t??o.account_name,p=r??o.account_type,l=n??o.owner,d=s??o.current_balance;if(await u.wp.execute({sql:`UPDATE accounts 
                  SET account_name = ?, account_type = ?, owner = ?, current_balance = ?, last_updated = CURRENT_TIMESTAMP
                  WHERE id = ?`,args:[i,p,l,d,a]}),void 0!==s&&Number(s)!==Number(o.current_balance)){let e=new Date().toISOString().split("T")[0];await u.wp.execute({sql:`INSERT INTO balance_history (account_id, balance, recorded_date)
                      VALUES (?, ?, ?)`,args:[a,d,e]})}return c.NextResponse.json({success:!0,balanceChanged:void 0!==s&&Number(s)!==Number(o.current_balance),previousBalance:o.current_balance,newBalance:d})}catch(e){return console.error("Error updating account:",e),c.NextResponse.json({error:"Failed to update account"},{status:500})}}async function l(e,t){let{id:a}=await t.params;try{return await u.wp.execute({sql:"DELETE FROM accounts WHERE id = ?",args:[a]}),c.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting account:",e),c.NextResponse.json({error:"Failed to delete account"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/accounts/[id]/route",pathname:"/api/accounts/[id]",filename:"route",bundlePath:"app/api/accounts/[id]/route"},resolvedPagePath:"C:\\Users\\G\\Desktop\\SavinGCs\\app\\api\\accounts\\[id]\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:E,staticGenerationAsyncStorage:w,serverHooks:R}=d,x="/api/accounts/[id]/route";function _(){return(0,o.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:w})}},4677:(e,t,a)=>{a.d(t,{wp:()=>n});let r=require("@libsql/client");require("fs"),a(1017),a(8691),process.env.DATABASE_URL?.includes("libsql")||process.env.DATABASE_URL?.includes("turso");let n=(0,r.createClient)({url:process.env.DATABASE_URL||"file:savings-tracker.db",authToken:process.env.DATABASE_AUTH_TOKEN});class s{prepare(e){return{get:async(...t)=>(await n.execute({sql:e,args:t})).rows[0],all:async(...t)=>(await n.execute({sql:e,args:t})).rows,run:async(...t)=>{let a=await n.execute({sql:e,args:t});return{lastInsertRowid:a.lastInsertRowid,changes:a.rowsAffected}}}}transaction(e){return async(...t)=>(console.warn("Transactions are not fully supported in async wrapper yet."),e(t))}pragma(e){}exec(e){return n.executeMultiple(e)}}new s}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948,972,691],()=>a(3903));module.exports=r})();