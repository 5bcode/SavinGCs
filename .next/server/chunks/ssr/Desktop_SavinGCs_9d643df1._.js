module.exports=[64283,(a,b,c)=>{},32436,(a,b,c)=>{a.r(64283);var d=a.r(48877),e=d&&"object"==typeof d&&"default"in d?d:{default:d},f="u">typeof process&&process.env&&!0,g=function(a){return"[object String]"===Object.prototype.toString.call(a)},h=function(){function a(a){var b=void 0===a?{}:a,c=b.name,d=void 0===c?"stylesheet":c,e=b.optimizeForSpeed,h=void 0===e?f:e;i(g(d),"`name` must be a string"),this._name=d,this._deletedRulePlaceholder="#"+d+"-deleted-rule____{}",i("boolean"==typeof h,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=h,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0,this._nonce=null}var b,c=a.prototype;return c.setOptimizeForSpeed=function(a){i("boolean"==typeof a,"`setOptimizeForSpeed` accepts a boolean"),i(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=a,this.inject()},c.isOptimizeForSpeed=function(){return this._optimizeForSpeed},c.inject=function(){var a=this;i(!this._injected,"sheet already injected"),this._injected=!0,this._serverSheet={cssRules:[],insertRule:function(b,c){return"number"==typeof c?a._serverSheet.cssRules[c]={cssText:b}:a._serverSheet.cssRules.push({cssText:b}),c},deleteRule:function(b){a._serverSheet.cssRules[b]=null}}},c.getSheetForTag=function(a){if(a.sheet)return a.sheet;for(var b=0;b<document.styleSheets.length;b++)if(document.styleSheets[b].ownerNode===a)return document.styleSheets[b]},c.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},c.insertRule=function(a,b){return i(g(a),"`insertRule` accepts only strings"),"number"!=typeof b&&(b=this._serverSheet.cssRules.length),this._serverSheet.insertRule(a,b),this._rulesCount++},c.replaceRule=function(a,b){this._optimizeForSpeed;var c=this._serverSheet;if(b.trim()||(b=this._deletedRulePlaceholder),!c.cssRules[a])return a;c.deleteRule(a);try{c.insertRule(b,a)}catch(d){f||console.warn("StyleSheet: illegal rule: \n\n"+b+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),c.insertRule(this._deletedRulePlaceholder,a)}return a},c.deleteRule=function(a){this._serverSheet.deleteRule(a)},c.flush=function(){this._injected=!1,this._rulesCount=0,this._serverSheet.cssRules=[]},c.cssRules=function(){return this._serverSheet.cssRules},c.makeStyleTag=function(a,b,c){b&&i(g(b),"makeStyleTag accepts only strings as second parameter");var d=document.createElement("style");this._nonce&&d.setAttribute("nonce",this._nonce),d.type="text/css",d.setAttribute("data-"+a,""),b&&d.appendChild(document.createTextNode(b));var e=document.head||document.getElementsByTagName("head")[0];return c?e.insertBefore(d,c):e.appendChild(d),d},b=[{key:"length",get:function(){return this._rulesCount}}],function(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}(a.prototype,b),a}();function i(a,b){if(!a)throw Error("StyleSheet: "+b+".")}var j=function(a){for(var b=5381,c=a.length;c;)b=33*b^a.charCodeAt(--c);return b>>>0},k={};function l(a,b){if(!b)return"jsx-"+a;var c=String(b),d=a+c;return k[d]||(k[d]="jsx-"+j(a+"-"+c)),k[d]}function m(a,b){var c=a+(b=b.replace(/\/style/gi,"\\/style"));return k[c]||(k[c]=b.replace(/__jsx-style-dynamic-selector/g,a)),k[c]}var n=function(){function a(a){var b=void 0===a?{}:a,c=b.styleSheet,d=void 0===c?null:c,e=b.optimizeForSpeed,f=void 0!==e&&e;this._sheet=d||new h({name:"styled-jsx",optimizeForSpeed:f}),this._sheet.inject(),d&&"boolean"==typeof f&&(this._sheet.setOptimizeForSpeed(f),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var b=a.prototype;return b.add=function(a){var b=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(a.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed());var c=this.getIdAndRules(a),d=c.styleId,e=c.rules;if(d in this._instancesCounts){this._instancesCounts[d]+=1;return}var f=e.map(function(a){return b._sheet.insertRule(a)}).filter(function(a){return -1!==a});this._indices[d]=f,this._instancesCounts[d]=1},b.remove=function(a){var b=this,c=this.getIdAndRules(a).styleId;if(function(a,b){if(!a)throw Error("StyleSheetRegistry: "+b+".")}(c in this._instancesCounts,"styleId: `"+c+"` not found"),this._instancesCounts[c]-=1,this._instancesCounts[c]<1){var d=this._fromServer&&this._fromServer[c];d?(d.parentNode.removeChild(d),delete this._fromServer[c]):(this._indices[c].forEach(function(a){return b._sheet.deleteRule(a)}),delete this._indices[c]),delete this._instancesCounts[c]}},b.update=function(a,b){this.add(b),this.remove(a)},b.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},b.cssRules=function(){var a=this,b=this._fromServer?Object.keys(this._fromServer).map(function(b){return[b,a._fromServer[b]]}):[],c=this._sheet.cssRules();return b.concat(Object.keys(this._indices).map(function(b){return[b,a._indices[b].map(function(a){return c[a].cssText}).join(a._optimizeForSpeed?"":"\n")]}).filter(function(a){return!!a[1]}))},b.styles=function(a){var b,c;return b=this.cssRules(),void 0===(c=a)&&(c={}),b.map(function(a){var b=a[0],d=a[1];return e.default.createElement("style",{id:"__"+b,key:"__"+b,nonce:c.nonce?c.nonce:void 0,dangerouslySetInnerHTML:{__html:d}})})},b.getIdAndRules=function(a){var b=a.children,c=a.dynamic,d=a.id;if(c){var e=l(d,c);return{styleId:e,rules:Array.isArray(b)?b.map(function(a){return m(e,a)}):[m(e,b)]}}return{styleId:l(d),rules:Array.isArray(b)?b:[b]}},b.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(a,b){return a[b.id.slice(2)]=b,a},{})},a}(),o=d.createContext(null);function p(){return new n}function q(){return d.useContext(o)}function r(a){var b=q();return b&&b.add(a),null}o.displayName="StyleSheetContext",e.default.useInsertionEffect||e.default.useLayoutEffect,r.dynamic=function(a){return a.map(function(a){return l(a[0],a[1])}).join(" ")},c.StyleRegistry=function(a){var b=a.registry,c=a.children,f=d.useContext(o),g=d.useState(function(){return f||b||p()})[0];return e.default.createElement(o.Provider,{value:g},c)},c.createStyleRegistry=p,c.style=r,c.useStyleRegistry=q},58117,(a,b,c)=>{b.exports=a.r(32436).style},34911,a=>{"use strict";var b=a.i(5507),c=a.i(48877);function d({onUpdateBalance:a,onAccountClick:d}){let[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!0);(0,c.useEffect)(()=>{n()},[]);let n=async()=>{try{let[a,b]=await Promise.all([fetch("/api/pots"),fetch("/api/accounts")]),c=await a.json(),d=await b.json();i(c.pots||[]),k(d.accounts||[])}catch(a){console.error("Error fetching data:",a)}finally{m(!1)}},o=h.reduce((a,b)=>a+(b.total_balance||0),0),p=h.reduce((a,b)=>a+(b.goal_amount||0),0),q=p>0?o/p*100:0;return l?(0,b.jsxs)("div",{className:"stack",children:[(0,b.jsx)("div",{className:"skeleton",style:{height:"220px"}}),(0,b.jsx)("div",{className:"skeleton",style:{height:"100px"}}),(0,b.jsx)("div",{className:"skeleton",style:{height:"80px"}})]}):(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{style:{textAlign:"center",padding:"var(--sp-lg) 0 var(--sp-md)"},children:[(0,b.jsx)("div",{className:"balance-label",children:"Total Net Worth"}),(0,b.jsxs)("div",{className:"balance-amount",children:["Â£",o.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})]}),p>0&&(0,b.jsxs)("div",{style:{fontSize:"0.8rem",color:"var(--text-tertiary)",marginTop:"6px"},children:[Math.min(q,100).toFixed(1),"% of Â£",p.toLocaleString("en-GB")," goal"]})]}),p>0&&(0,b.jsxs)("div",{className:"credit-card mb-lg",style:{position:"relative"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"var(--sp-xl)",position:"relative",zIndex:1},children:[(0,b.jsx)(g,{percentage:Math.min(q,100),size:96,strokeWidth:7,children:(0,b.jsxs)("div",{style:{textAlign:"center"},children:[(0,b.jsxs)("div",{style:{fontFamily:"var(--font-mono)",fontSize:"1rem",fontWeight:700,color:"white",lineHeight:1},children:[Math.min(q,100).toFixed(0),"%"]}),(0,b.jsx)("div",{style:{fontSize:"0.55rem",color:"rgba(255,255,255,0.6)",marginTop:"2px"},children:"saved"})]})}),(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsx)("div",{style:{fontSize:"0.7rem",fontWeight:600,opacity:.7,letterSpacing:"0.1em",textTransform:"uppercase",marginBottom:"4px"},children:"Savings Progress"}),(0,b.jsxs)("div",{style:{fontFamily:"var(--font-mono)",fontSize:"1.4rem",fontWeight:700,color:"white"},children:["Â£",o.toLocaleString("en-GB",{minimumFractionDigits:2})]}),(0,b.jsxs)("div",{style:{fontSize:"0.75rem",opacity:.6,marginTop:"4px"},children:["Â£",(p-o>0?p-o:0).toLocaleString("en-GB")," remaining"]})]})]}),(0,b.jsx)("div",{className:"wave-decoration",children:(0,b.jsxs)("svg",{viewBox:"0 0 400 80",fill:"none",preserveAspectRatio:"none",children:[(0,b.jsx)("path",{d:"M0 40 Q50 10 100 35 T200 30 T300 40 T400 25 L400 80 L0 80Z",fill:"rgba(13,148,136,0.3)"}),(0,b.jsx)("path",{d:"M0 50 Q60 25 120 45 T240 35 T360 50 T400 40 L400 80 L0 80Z",fill:"rgba(13,148,136,0.15)"})]})})]}),(0,b.jsxs)("button",{className:"btn btn-primary mb-lg",style:{width:"100%"},onClick:a,children:[(0,b.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),(0,b.jsx)("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),"Update Balances"]}),(0,b.jsxs)("div",{className:"section-header",children:[(0,b.jsx)("div",{className:"section-title",children:"Savings Pots"}),(0,b.jsxs)("div",{className:"section-link",children:[h.length," pot",1!==h.length?"s":""]})]}),0===h.length?(0,b.jsxs)("div",{className:"empty-state",children:[(0,b.jsx)("div",{className:"empty-state-icon",children:"ðŸ¡"}),(0,b.jsxs)("div",{className:"empty-state-text",children:["No savings pots yet.",(0,b.jsx)("br",{}),"Go to Settings to create your first one!"]})]}):(0,b.jsx)("div",{className:"stack mb-xl",children:h.map(a=>{let c=j.filter(b=>b.pot_id===a.id);return(0,b.jsx)(e,{pot:a,accounts:c,onAccountClick:d},a.id)})}),j.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"section-header",children:[(0,b.jsx)("div",{className:"section-title",children:"All Accounts"}),(0,b.jsxs)("div",{className:"section-link",children:[j.length," account",1!==j.length?"s":""]})]}),(0,b.jsx)("div",{className:"stack",style:{gap:"var(--sp-sm)"},children:j.map(a=>(0,b.jsx)(f,{account:a,onClick:()=>d(a.id)},a.id))})]})]})}function e({pot:a,accounts:c,onAccountClick:d}){let e=Math.min(a.goal_amount?a.total_balance/a.goal_amount*100:0,100),f=a.goal_amount&&a.total_balance>=a.goal_amount;return(0,b.jsxs)("div",{className:"card",style:{padding:"var(--sp-lg)"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-md",children:[(0,b.jsxs)("div",{className:"flex items-center gap-md",children:[(0,b.jsx)("div",{className:"pot-icon",style:{background:`${a.color}25`},children:{"piggy-bank":"ðŸ·",house:"ðŸ¡",car:"ðŸš—",vacation:"ðŸ–ï¸",emergency:"ðŸš¨",wedding:"ðŸ’",education:"ðŸŽ“",savings:"ðŸ’°"}[a.icon]||"ðŸ’°"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{fontWeight:700,fontSize:"1rem"},children:a.name}),a.goal_amount&&(0,b.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",marginTop:"2px"},children:["Goal: Â£",a.goal_amount.toLocaleString("en-GB")]})]})]}),(0,b.jsxs)("div",{style:{textAlign:"right"},children:[(0,b.jsxs)("div",{style:{fontFamily:"var(--font-mono)",fontWeight:700,fontSize:"1.1rem",color:"var(--text-primary)"},children:["Â£",a.total_balance.toLocaleString("en-GB",{minimumFractionDigits:2})]}),f&&(0,b.jsx)("div",{style:{fontSize:"0.7rem",color:"var(--success)",fontWeight:600,marginTop:"2px"},children:"âœ“ Goal reached"})]})]}),a.goal_amount&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"progress-track",style:{height:"8px",marginTop:0,marginBottom:"6px"},children:(0,b.jsx)("div",{className:`progress-fill${f?"":" purple"}`,style:{width:`${e}%`}})}),(0,b.jsxs)("div",{className:"flex justify-between",style:{fontSize:"0.7rem",color:"var(--text-tertiary)"},children:[(0,b.jsxs)("span",{children:[e.toFixed(1),"% complete"]}),(0,b.jsxs)("span",{children:["Â£",Math.max(0,(a.goal_amount||0)-a.total_balance).toLocaleString("en-GB")," to go"]})]})]}),c.length>0&&(0,b.jsx)("div",{style:{marginTop:"var(--sp-md)",paddingTop:"var(--sp-md)",borderTop:"1px solid var(--border)"},children:c.map(c=>(0,b.jsxs)("div",{className:"flex justify-between items-center",style:{padding:"6px 0",cursor:"pointer"},onClick:()=>d(c.id),children:[(0,b.jsxs)("div",{className:"flex items-center gap-sm",children:[(0,b.jsx)("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:a.color,flexShrink:0}}),(0,b.jsx)("span",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:c.account_name}),(0,b.jsxs)("span",{style:{fontSize:"0.65rem",color:"var(--text-tertiary)",padding:"1px 6px",background:"var(--bg-secondary)",borderRadius:"var(--r-sm)"},children:[c.account_type.toUpperCase()," Â· ",c.owner||"Joint"]})]}),(0,b.jsxs)("span",{style:{fontFamily:"var(--font-mono)",fontSize:"0.85rem",fontWeight:600,color:"var(--text-primary)"},children:["Â£",c.current_balance.toLocaleString("en-GB",{minimumFractionDigits:2})]})]},c.id))})]})}function f({account:a,onClick:c}){return(0,b.jsxs)("div",{className:"pot-item",onClick:c,children:[(0,b.jsx)("div",{className:"pot-icon",style:{background:`linear-gradient(135deg, ${a.pot_color||"var(--purple-start)"}30, ${a.pot_color||"var(--purple-start)"}10)`,fontSize:"1rem"},children:(0,b.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:a.pot_color||"var(--purple-mid)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),(0,b.jsx)("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]})}),(0,b.jsxs)("div",{className:"pot-info",children:[(0,b.jsx)("div",{className:"pot-name",children:a.account_name}),(0,b.jsxs)("div",{className:"pot-meta",children:[a.pot_name," Â· ",a.account_type," Â· ",a.owner||"Joint"]})]}),(0,b.jsxs)("div",{className:"pot-amount",children:["Â£",a.current_balance.toLocaleString("en-GB",{minimumFractionDigits:2})]})]})}function g({percentage:a,size:c=96,strokeWidth:d=7,children:e}){let f=(c-d)/2,g=2*f*Math.PI;return(0,b.jsxs)("div",{className:"ring-container",style:{width:c,height:c},children:[(0,b.jsxs)("svg",{width:c,height:c,viewBox:`0 0 ${c} ${c}`,children:[(0,b.jsx)("circle",{className:"ring-bg",cx:c/2,cy:c/2,r:f}),(0,b.jsx)("circle",{className:"ring-fill",cx:c/2,cy:c/2,r:f,stroke:"url(#ringGrad)",strokeDasharray:g,strokeDashoffset:g-a/100*g}),(0,b.jsx)("defs",{children:(0,b.jsxs)("linearGradient",{id:"ringGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,b.jsx)("stop",{offset:"0%",stopColor:"var(--purple-start)"}),(0,b.jsx)("stop",{offset:"100%",stopColor:"var(--teal-end)"})]})})]}),(0,b.jsx)("div",{className:"ring-text",children:e})]})}var h=a.i(58117);function i({onLogin:a}){let[d,e]=(0,c.useState)(""),[f,g]=(0,c.useState)(""),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(!1),o=async b=>{b.preventDefault(),l(""),n(!0);try{let b=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:d,password:f,rememberMe:i})}),c=await b.json();if(!b.ok)return void l(c.error||"Login failed");a(c.user)}catch(a){l("An error occurred. Please try again.")}finally{n(!1)}};return(0,b.jsxs)("div",{className:"jsx-37a81b79a982207d login-page",children:[(0,b.jsxs)("div",{className:"jsx-37a81b79a982207d login-card",children:[(0,b.jsxs)("div",{className:"jsx-37a81b79a982207d login-brand",children:[(0,b.jsx)("div",{className:"jsx-37a81b79a982207d login-logo",children:"ðŸ¡"}),(0,b.jsx)("h1",{className:"jsx-37a81b79a982207d login-title",children:"SavinGCs"}),(0,b.jsx)("p",{className:"jsx-37a81b79a982207d login-subtitle",children:"Track your savings together"})]}),(0,b.jsxs)("form",{onSubmit:o,className:"jsx-37a81b79a982207d card-glass",children:[(0,b.jsxs)("div",{className:"jsx-37a81b79a982207d form-group",children:[(0,b.jsx)("label",{htmlFor:"username",className:"jsx-37a81b79a982207d form-label",children:"Username"}),(0,b.jsx)("input",{id:"username",type:"text",value:d,onChange:a=>e(a.target.value),placeholder:"Enter username",required:!0,autoComplete:"username",className:"jsx-37a81b79a982207d form-input"})]}),(0,b.jsxs)("div",{className:"jsx-37a81b79a982207d form-group",children:[(0,b.jsx)("label",{htmlFor:"password",className:"jsx-37a81b79a982207d form-label",children:"Password"}),(0,b.jsx)("input",{id:"password",type:"password",value:f,onChange:a=>g(a.target.value),placeholder:"Enter password",required:!0,autoComplete:"current-password",className:"jsx-37a81b79a982207d form-input"})]}),(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"var(--sp-sm)",cursor:"pointer",marginBottom:"var(--sp-lg)",WebkitTapHighlightColor:"transparent"},className:"jsx-37a81b79a982207d",children:[(0,b.jsx)("input",{type:"checkbox",checked:i,onChange:a=>j(a.target.checked),style:{width:"18px",height:"18px",accentColor:"var(--purple-start)",cursor:"pointer"},className:"jsx-37a81b79a982207d"}),(0,b.jsx)("span",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},className:"jsx-37a81b79a982207d",children:"Remember me"})]}),k&&(0,b.jsx)("div",{className:"jsx-37a81b79a982207d error-badge",children:k}),(0,b.jsx)("button",{type:"submit",style:{width:"100%"},disabled:m,className:"jsx-37a81b79a982207d btn btn-primary",children:m?(0,b.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"8px"},className:"jsx-37a81b79a982207d",children:[(0,b.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",style:{animation:"spin 1s linear infinite"},className:"jsx-37a81b79a982207d",children:(0,b.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:"60 30",className:"jsx-37a81b79a982207d"})}),"Signing in..."]}):"Sign In"})]})]}),(0,b.jsx)(h.default,{id:"37a81b79a982207d",children:"@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"})]})}function j(){let[a,d]=(0,c.useState)([]),[e,f]=(0,c.useState)(!0);(0,c.useEffect)(()=>{g()},[]);let g=async()=>{try{let a=await fetch("/api/transactions"),b=await a.json();d(b.transactions||[])}catch(a){console.error("Error fetching transactions:",a)}finally{f(!1)}},h=async()=>{try{let a=await fetch("/api/export/csv"),b=await a.blob(),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`savings-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(c),document.body.removeChild(d)}catch(a){console.error("Export error:",a)}};if(e)return(0,b.jsx)("div",{className:"skeleton",style:{height:"300px"}});let i={};return a.forEach(a=>{let b=new Date(a.transaction_date).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});i[b]||(i[b]=[]),i[b].push(a)}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"section-header",children:[(0,b.jsx)("div",{className:"section-title",children:"Balance History"}),(0,b.jsxs)("button",{className:"btn btn-secondary",style:{padding:"8px 14px",minHeight:"auto",fontSize:"0.75rem"},onClick:h,children:[(0,b.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,b.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,b.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Export"]})]}),(0,b.jsx)("p",{style:{fontSize:"0.8rem",color:"var(--text-tertiary)",marginBottom:"var(--sp-lg)"},children:"A log of all balance changes across your accounts."}),0===a.length?(0,b.jsxs)("div",{className:"empty-state",children:[(0,b.jsx)("div",{className:"empty-state-icon",children:"ðŸ“‹"}),(0,b.jsxs)("div",{className:"empty-state-text",children:["No history yet.",(0,b.jsx)("br",{}),"Balance changes will appear here."]})]}):Object.entries(i).map(([a,c])=>(0,b.jsxs)("div",{style:{marginBottom:"var(--sp-xl)"},children:[(0,b.jsx)("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em",marginBottom:"var(--sp-sm)",padding:"0 2px"},children:a}),(0,b.jsx)("div",{className:"stack",style:{gap:"var(--sp-xs)"},children:c.map(a=>(0,b.jsxs)("div",{className:"pot-item",style:{cursor:"default",padding:"var(--sp-sm) var(--sp-md)"},children:[(0,b.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"var(--r-md)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,fontSize:"1rem",background:a.amount>=0?"linear-gradient(135deg, rgba(52, 211, 153, 0.15), rgba(52, 211, 153, 0.05))":"linear-gradient(135deg, rgba(248, 113, 113, 0.15), rgba(248, 113, 113, 0.05))"},children:a.amount>=0?"â†—":"â†™"}),(0,b.jsxs)("div",{className:"pot-info",children:[(0,b.jsx)("div",{style:{fontWeight:600,fontSize:"0.85rem"},children:a.account_name}),(0,b.jsxs)("div",{style:{fontSize:"0.7rem",color:"var(--text-tertiary)"},children:[a.description||a.pot_name," â€¢ ",a.user_name]})]}),(0,b.jsxs)("span",{style:{fontFamily:"var(--font-mono)",fontWeight:700,fontSize:"0.9rem",color:a.amount>=0?"var(--success)":"var(--error)"},children:[a.amount>=0?"+":"","Â£",Math.abs(a.amount).toLocaleString("en-GB",{minimumFractionDigits:2})]})]},a.id))})]},a))]})}function k({onUpdate:a}){let[d,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)({name:"",goalAmount:"",color:"#7B2FE0",icon:"piggy-bank"});(0,c.useEffect)(()=>{j()},[]);let j=async()=>{try{let a=await fetch("/api/pots"),b=await a.json();e(b.pots||[])}catch(a){console.error("Error fetching pots:",a)}},k=async b=>{b.preventDefault();try{if(!(await fetch("/api/pots",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:h.name,goalAmount:h.goalAmount?parseFloat(h.goalAmount):null,color:h.color,icon:h.icon,priority:0})})).ok)throw Error("Failed to create pot");i({name:"",goalAmount:"",color:"#7B2FE0",icon:"piggy-bank"}),g(!1),j(),a()}catch(a){console.error("Error creating pot:",a),alert("Failed to create savings pot")}},l=async b=>{if(confirm("Delete this pot and all its accounts/transactions?"))try{if(!(await fetch(`/api/pots/${b}`,{method:"DELETE"})).ok)throw Error("Failed to delete pot");j(),a()}catch(a){console.error("Error deleting pot:",a),alert("Failed to delete pot")}},m=[["house","ðŸ¡"],["piggy-bank","ðŸ·"],["car","ðŸš—"],["vacation","ðŸ–ï¸"],["emergency","ðŸš¨"],["wedding","ðŸ’"],["education","ðŸŽ“"],["savings","ðŸ’°"]];return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"section-header",children:[(0,b.jsx)("div",{className:"section-title",children:"Savings Pots"}),(0,b.jsx)("button",{className:"btn btn-primary",style:{padding:"8px 16px",minHeight:"auto",fontSize:"0.8rem"},onClick:()=>g(!f),children:f?"Cancel":"+ New Pot"})]}),f&&(0,b.jsxs)("form",{onSubmit:k,className:"card mb-lg",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Pot Name"}),(0,b.jsx)("input",{type:"text",className:"form-input",value:h.name,onChange:a=>i({...h,name:a.target.value}),placeholder:"e.g., House Deposit",required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Goal Amount (Â£)"}),(0,b.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:h.goalAmount,onChange:a=>i({...h,goalAmount:a.target.value}),placeholder:"Optional - e.g., 50000"})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Icon"}),(0,b.jsx)("div",{className:"flex gap-sm",style:{flexWrap:"wrap"},children:m.map(([a,c])=>(0,b.jsx)("button",{type:"button",onClick:()=>i({...h,icon:a}),style:{width:"44px",height:"44px",borderRadius:"var(--r-md)",background:h.icon===a?"var(--purple-start)":"var(--bg-secondary)",border:h.icon===a?"2px solid var(--purple-mid)":"1px solid var(--border)",fontSize:"1.2rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all var(--t-fast)"},children:c},a))})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Color"}),(0,b.jsx)("div",{className:"flex gap-sm",children:["#7B2FE0","#059669","#f59e0b","#ef4444","#3b82f6","#ec4899","#8b5cf6"].map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>i({...h,color:a}),style:{width:"36px",height:"36px",borderRadius:"var(--r-full)",background:a,border:h.color===a?"3px solid white":"2px solid transparent",cursor:"pointer",transition:"all var(--t-fast)"}},a))})]}),(0,b.jsx)("button",{type:"submit",className:"btn btn-teal",style:{width:"100%"},children:"Create Pot"})]}),(0,b.jsx)("div",{className:"stack",style:{gap:"var(--sp-sm)"},children:d.map(a=>{let c="Unallocated"===a.name;return(0,b.jsxs)("div",{className:"pot-item",children:[(0,b.jsx)("div",{className:"pot-icon",style:{background:`${a.color}30`,fontSize:"1.3rem"},children:m.find(([b])=>b===a.icon)?.[1]||"ðŸ’°"}),(0,b.jsxs)("div",{className:"pot-info",children:[(0,b.jsx)("div",{className:"pot-name",children:a.name}),c?(0,b.jsx)("div",{className:"pot-meta",children:"Default Â· Cannot be deleted"}):a.goal_amount?(0,b.jsxs)("div",{className:"pot-meta",children:["Goal: Â£",a.goal_amount.toLocaleString("en-GB")]}):null]}),!c&&(0,b.jsx)("button",{onClick:()=>l(a.id),className:"icon-btn",style:{color:"var(--error)"},children:(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,b.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},a.id)})})]})}function l({onUpdate:a,onAccountClick:d}){let[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)({potId:"",accountName:"",accountType:"savings",owner:"Joint",currentBalance:""});(0,c.useEffect)(()=>{m()},[]);let m=async()=>{try{let[a,b]=await Promise.all([fetch("/api/accounts"),fetch("/api/pots")]),c=await a.json(),d=(await b.json()).pots||[];if(f(c.accounts||[]),h(d),!k.potId){let a=d.find(a=>"Unallocated"===a.name);a&&l(b=>({...b,potId:String(a.id)}))}}catch(a){console.error("Error fetching data:",a)}},n=async b=>{b.preventDefault();try{if(!(await fetch("/api/accounts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({potId:parseInt(k.potId),accountName:k.accountName,accountType:k.accountType,owner:k.owner,currentBalance:parseFloat(k.currentBalance)||0})})).ok)throw Error("Failed to create account");l({potId:"",accountName:"",accountType:"savings",owner:"Joint",currentBalance:""}),j(!1),m(),a()}catch(a){console.error("Error creating account:",a),alert("Failed to create account")}},o=async b=>{if(confirm("Delete this account and all its transactions?"))try{if(!(await fetch(`/api/accounts/${b}`,{method:"DELETE"})).ok)throw Error("Failed to delete account");m(),a()}catch(a){console.error("Error deleting account:",a),alert("Failed to delete account")}},p={savings:"Savings",isa:"ISA",current:"Current",investment:"Investment",other:"Other"},q={};return e.forEach(a=>{q[a.pot_name]||(q[a.pot_name]={color:a.pot_color,accounts:[]}),q[a.pot_name].accounts.push(a)}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"section-header",children:[(0,b.jsx)("div",{className:"section-title",children:"Your Accounts"}),(0,b.jsx)("button",{className:"btn btn-primary",style:{padding:"8px 16px",minHeight:"auto",fontSize:"0.8rem"},onClick:()=>j(!i),children:i?"Cancel":"+ Add Account"})]}),(0,b.jsx)("p",{style:{fontSize:"0.8rem",color:"var(--text-tertiary)",marginBottom:"var(--sp-lg)"},children:"All your savings accounts, grouped by pot."}),i&&(0,b.jsxs)("form",{onSubmit:n,className:"card mb-lg",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Savings Pot"}),(0,b.jsx)("select",{className:"form-select",value:k.potId,onChange:a=>l({...k,potId:a.target.value}),required:!0,children:g.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Account Name"}),(0,b.jsx)("input",{type:"text",className:"form-input",value:k.accountName,onChange:a=>l({...k,accountName:a.target.value}),placeholder:"e.g., HSBC Lifetime ISA",required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Account Type"}),(0,b.jsxs)("select",{className:"form-select",value:k.accountType,onChange:a=>l({...k,accountType:a.target.value}),children:[(0,b.jsx)("option",{value:"savings",children:"Savings Account"}),(0,b.jsx)("option",{value:"isa",children:"ISA"}),(0,b.jsx)("option",{value:"current",children:"Current Account"}),(0,b.jsx)("option",{value:"investment",children:"Investment Account"}),(0,b.jsx)("option",{value:"other",children:"Other"})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Owner"}),(0,b.jsxs)("select",{className:"form-select",value:k.owner,onChange:a=>l({...k,owner:a.target.value}),children:[(0,b.jsx)("option",{value:"Gary",children:"Gary"}),(0,b.jsx)("option",{value:"Catherine",children:"Catherine"}),(0,b.jsx)("option",{value:"Joint",children:"Joint"})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Current Balance (Â£)"}),(0,b.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:k.currentBalance,onChange:a=>l({...k,currentBalance:a.target.value}),placeholder:"0.00",style:{fontFamily:"var(--font-mono)"}})]}),(0,b.jsx)("button",{type:"submit",className:"btn btn-teal",style:{width:"100%"},children:"Add Account"})]}),0===Object.keys(q).length&&!i&&(0,b.jsxs)("div",{className:"empty-state",children:[(0,b.jsx)("div",{className:"empty-state-icon",children:"ðŸ¦"}),(0,b.jsxs)("div",{className:"empty-state-text",children:["No accounts yet.",(0,b.jsx)("br",{}),"Add your first bank account above!"]})]}),Object.entries(q).map(([a,c])=>{let e=c.accounts.reduce((a,b)=>a+b.current_balance,0);return(0,b.jsxs)("div",{style:{marginBottom:"var(--sp-xl)"},children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",style:{marginBottom:"var(--sp-sm)",padding:"0 2px"},children:[(0,b.jsxs)("div",{className:"flex items-center gap-sm",children:[(0,b.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:c.color}}),(0,b.jsx)("span",{style:{fontSize:"0.75rem",fontWeight:700,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em"},children:a})]}),(0,b.jsxs)("span",{style:{fontSize:"0.8rem",fontFamily:"var(--font-mono)",fontWeight:600,color:"var(--text-secondary)"},children:["Â£",e.toLocaleString("en-GB",{minimumFractionDigits:2})]})]}),(0,b.jsx)("div",{className:"stack",style:{gap:"var(--sp-xs)"},children:c.accounts.map(a=>(0,b.jsxs)("div",{className:"pot-item",onClick:()=>d(a.id),children:[(0,b.jsx)("div",{className:"pot-icon",style:{background:`linear-gradient(135deg, ${a.pot_color}30, ${a.pot_color}10)`,fontSize:"1rem"},children:(0,b.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:a.pot_color||"var(--purple-mid)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),(0,b.jsx)("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]})}),(0,b.jsxs)("div",{className:"pot-info",children:[(0,b.jsx)("div",{className:"pot-name",children:a.account_name}),(0,b.jsxs)("div",{className:"pot-meta",children:[p[a.account_type]||a.account_type," Â· ",a.owner||"Joint"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-sm",children:[(0,b.jsxs)("div",{className:"pot-amount",children:["Â£",a.current_balance.toLocaleString("en-GB",{minimumFractionDigits:2})]}),(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),o(a.id)},className:"icon-btn",style:{color:"var(--error)",width:"32px",height:"32px"},children:(0,b.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,b.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},a.id))})]},a)})]})}function m({onSuccess:a,currentUser:d}){let[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)({}),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(new Set);(0,c.useEffect)(()=>{o()},[]);let o=async()=>{try{let a=await fetch("/api/accounts"),b=(await a.json()).accounts||[];f(b);let c={};b.forEach(a=>{c[a.id]=a.current_balance.toFixed(2)}),h(c)}catch(a){console.error("Error fetching accounts:",a)}finally{j(!1)}},p=async a=>{let b=parseFloat(g[a.id]||"0");if(!isNaN(b)){l(!0);try{if(!(await fetch(`/api/accounts/${a.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountName:a.account_name,accountType:a.account_type,currentBalance:b})})).ok)throw Error("Failed to update");let c=b-a.current_balance;0!==c&&await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountId:a.id,userId:d.id,amount:c,description:`Balance update: \xa3${a.current_balance.toFixed(2)} â†’ \xa3${b.toFixed(2)}`,transactionDate:new Date().toISOString().split("T")[0]})}),n(b=>new Set(b).add(a.id)),setTimeout(()=>n(b=>{let c=new Set(b);return c.delete(a.id),c}),2e3)}catch(a){console.error("Error updating balance:",a),alert("Failed to update balance")}finally{l(!1)}}},q=async()=>{for(let a of(l(!0),e)){let b=parseFloat(g[a.id]||"0");isNaN(b)||b===a.current_balance||await p(a)}l(!1),a()};if(i)return(0,b.jsx)("div",{className:"skeleton",style:{height:"200px"}});let r={};return e.forEach(a=>{r[a.pot_name]||(r[a.pot_name]=[]),r[a.pot_name].push(a)}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{style:{marginBottom:"var(--sp-xs)"},children:"Update Balances"}),(0,b.jsx)("p",{style:{fontSize:"0.8rem",color:"var(--text-tertiary)",marginBottom:"var(--sp-lg)"},children:"Enter the current balance for each account. Changes are logged automatically."}),0===e.length?(0,b.jsxs)("div",{className:"empty-state",children:[(0,b.jsx)("div",{className:"empty-state-icon",children:"ðŸ¦"}),(0,b.jsx)("div",{className:"empty-state-text",children:"No accounts yet. Add some in Settings first!"})]}):(0,b.jsxs)(b.Fragment,{children:[Object.entries(r).map(([a,c])=>(0,b.jsxs)("div",{style:{marginBottom:"var(--sp-lg)"},children:[(0,b.jsx)("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em",marginBottom:"var(--sp-sm)",padding:"0 2px"},children:a}),(0,b.jsx)("div",{className:"stack",style:{gap:"var(--sp-sm)"},children:c.map(a=>(0,b.jsxs)("div",{className:"card",style:{padding:"var(--sp-md)"},children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{fontWeight:600,fontSize:"0.9rem"},children:a.account_name}),(0,b.jsxs)("div",{style:{fontSize:"0.7rem",color:"var(--text-tertiary)"},children:["Current: Â£",a.current_balance.toLocaleString("en-GB",{minimumFractionDigits:2})," Â· ",a.account_type," Â· ",a.owner||"Joint"]})]}),m.has(a.id)&&(0,b.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--success)",fontWeight:600,display:"flex",alignItems:"center",gap:"4px"},children:[(0,b.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,b.jsx)("polyline",{points:"20 6 9 17 4 12"})}),"Saved"]})]}),(0,b.jsxs)("div",{className:"flex gap-sm items-center",children:[(0,b.jsxs)("div",{style:{position:"relative",flex:1},children:[(0,b.jsx)("span",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-tertiary)",fontWeight:600,fontSize:"1rem"},children:"Â£"}),(0,b.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:g[a.id]||"",onChange:b=>h({...g,[a.id]:b.target.value}),style:{paddingLeft:"28px",fontFamily:"var(--font-mono)",fontWeight:700,fontSize:"1.05rem"}})]}),(0,b.jsx)("button",{type:"button",className:"btn btn-teal",style:{padding:"12px 16px",minHeight:"auto",fontSize:"0.8rem"},onClick:()=>p(a),disabled:k||parseFloat(g[a.id]||"0")===a.current_balance,children:"Save"})]}),parseFloat(g[a.id]||"0")!==a.current_balance&&(0,b.jsxs)("div",{style:{fontSize:"0.75rem",marginTop:"6px",fontWeight:600,fontFamily:"var(--font-mono)",color:parseFloat(g[a.id]||"0")>a.current_balance?"var(--success)":"var(--error)"},children:[parseFloat(g[a.id]||"0")>a.current_balance?"+":"","Â£",(parseFloat(g[a.id]||"0")-a.current_balance).toLocaleString("en-GB",{minimumFractionDigits:2})," change"]})]},a.id))})]},a)),(0,b.jsx)("button",{className:"btn btn-primary",style:{width:"100%",marginTop:"var(--sp-md)"},onClick:q,disabled:k,children:k?"Saving...":"Save All Changes"})]})]})}function n({accountId:a,currentUser:d,onClose:e,onUpdate:f}){let[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(0),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)("");(0,c.useEffect)(()=>{C()},[a]);let C=async()=>{try{let b=await fetch(`/api/accounts/${a}`),c=await b.json();if(!b.ok)throw Error(c.error);h(c.account),j(c.history||[]),l(c.transactionCount||0),x(c.account.current_balance.toFixed(2)),z(c.account.account_type),B(c.account.owner||"Joint")}catch(a){console.error("Error fetching account:",a)}finally{n(!1)}},D=()=>!!g&&(y!==g.account_type||A!==(g.owner||"Joint")),E=async()=>{if(g){if(D()&&k>0&&!s){v({accountName:g.account_name,accountType:y,owner:A,currentBalance:parseFloat(w)}),t(!0);return}await F()}},F=async()=>{p(!0),t(!1);try{let b=parseFloat(w);if(!(await fetch(`/api/accounts/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountName:g.account_name,accountType:y,owner:A,currentBalance:b})})).ok)throw Error("Failed to update");let c=b-g.current_balance;0!==c&&await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountId:g.id,userId:d.id,amount:c,description:`Balance update: \xa3${g.current_balance.toFixed(2)} â†’ \xa3${b.toFixed(2)}`,transactionDate:new Date().toISOString().split("T")[0]})}),r(!0),setTimeout(()=>{r(!1),f(),e()},1200)}catch(a){console.error("Error saving:",a),alert("Failed to save changes")}finally{p(!1)}},G=g?parseFloat(w)-g.current_balance:0,H=new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});return m?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"skeleton",style:{height:"40px",marginBottom:"16px"}}),(0,b.jsx)("div",{className:"skeleton",style:{height:"200px"}})]}):g?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{style:{marginBottom:"var(--sp-lg)"},children:[(0,b.jsx)("h2",{style:{marginBottom:"4px"},children:g.account_name}),(0,b.jsxs)("div",{style:{fontSize:"0.8rem",color:"var(--text-tertiary)"},children:[g.pot_name," Â· ",{savings:"Savings",isa:"ISA",current:"Current",investment:"Investment",other:"Other"}[g.account_type]||g.account_type," Â· ",g.owner||"Joint"]}),(0,b.jsxs)("div",{style:{fontSize:"0.7rem",color:"var(--text-tertiary)",marginTop:"4px"},children:["Recording as at ",H]})]}),(0,b.jsxs)("div",{className:"card",style:{padding:"var(--sp-lg)",marginBottom:"var(--sp-lg)",textAlign:"center"},children:[(0,b.jsx)("div",{style:{fontSize:"0.7rem",fontWeight:600,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em",marginBottom:"6px"},children:"Current Balance"}),(0,b.jsxs)("div",{style:{fontFamily:"var(--font-mono)",fontSize:"2rem",fontWeight:700,color:"var(--text-primary)"},children:["Â£",g.current_balance.toLocaleString("en-GB",{minimumFractionDigits:2})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"New Balance (Â£)"}),(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("span",{style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"var(--text-tertiary)",fontWeight:700,fontSize:"1.1rem"},children:"Â£"}),(0,b.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:w,onChange:a=>x(a.target.value),style:{paddingLeft:"30px",fontFamily:"var(--font-mono)",fontWeight:700,fontSize:"1.2rem"}})]}),0!==G&&!isNaN(G)&&(0,b.jsxs)("div",{style:{fontSize:"0.8rem",marginTop:"6px",fontWeight:700,fontFamily:"var(--font-mono)",color:G>0?"var(--success)":"var(--error)",display:"flex",alignItems:"center",gap:"4px"},children:[G>0?"â†‘":"â†“"," ",G>0?"+":"","Â£",G.toLocaleString("en-GB",{minimumFractionDigits:2})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Account Type"}),(0,b.jsxs)("select",{className:"form-select",value:y,onChange:a=>z(a.target.value),children:[(0,b.jsx)("option",{value:"savings",children:"Savings Account"}),(0,b.jsx)("option",{value:"isa",children:"ISA"}),(0,b.jsx)("option",{value:"current",children:"Current Account"}),(0,b.jsx)("option",{value:"investment",children:"Investment Account"}),(0,b.jsx)("option",{value:"other",children:"Other"})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Owner"}),(0,b.jsxs)("select",{className:"form-select",value:A,onChange:a=>B(a.target.value),children:[(0,b.jsx)("option",{value:"Gary",children:"Gary"}),(0,b.jsx)("option",{value:"Catherine",children:"Catherine"}),(0,b.jsx)("option",{value:"Joint",children:"Joint"})]})]}),s&&(0,b.jsx)("div",{style:{background:"rgba(251, 191, 36, 0.1)",border:"1px solid rgba(251, 191, 36, 0.3)",borderRadius:"var(--r-lg)",padding:"var(--sp-md)",marginBottom:"var(--sp-md)"},children:(0,b.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"var(--sp-sm)"},children:[(0,b.jsx)("span",{style:{fontSize:"1.2rem",lineHeight:1},children:"âš ï¸"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{fontWeight:700,fontSize:"0.85rem",color:"var(--warning)",marginBottom:"4px"},children:"Changing account details"}),(0,b.jsxs)("div",{style:{fontSize:"0.78rem",color:"var(--text-secondary)",lineHeight:1.5},children:["This account has ",(0,b.jsxs)("strong",{children:[k," balance change",1!==k?"s":""]})," in its history. Changing the type or owner won't affect historical records, but could make past entries misleading."]}),(0,b.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",marginTop:"6px",lineHeight:1.5},children:["ðŸ’¡ ",(0,b.jsx)("strong",{children:"Recommendation:"})," If this is a fundamentally different account, consider deleting this one and creating a new account instead to keep your history clean."]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"var(--sp-sm)",marginTop:"var(--sp-md)"},children:[(0,b.jsx)("button",{className:"btn btn-secondary",style:{flex:1,padding:"10px",minHeight:"auto",fontSize:"0.8rem"},onClick:()=>t(!1),children:"Cancel"}),(0,b.jsx)("button",{className:"btn",style:{flex:1,padding:"10px",minHeight:"auto",fontSize:"0.8rem",background:"var(--warning)",color:"#000",fontWeight:700},onClick:F,children:"Save Anyway"})]})]})]})}),!s&&(0,b.jsx)("button",{className:"btn btn-primary",style:{width:"100%",marginBottom:"var(--sp-lg)"},onClick:E,disabled:o||q||!(g&&parseFloat(w)!==g.current_balance)&&!D(),children:q?(0,b.jsxs)("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[(0,b.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,b.jsx)("polyline",{points:"20 6 9 17 4 12"})}),"Saved"]}):o?"Saving...":"Save Changes"}),i.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"section-header",style:{marginTop:"var(--sp-md)"},children:[(0,b.jsx)("div",{className:"section-title",style:{fontSize:"0.95rem"},children:"Balance History"}),(0,b.jsxs)("div",{className:"section-link",children:[i.length," record",1!==i.length?"s":""]})]}),(0,b.jsx)("div",{className:"stack",style:{gap:"var(--sp-xs)"},children:i.map((a,c)=>{let d=c<i.length-1?i[c+1].balance:null,e=null!==d?a.balance-d:null;return(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--sp-sm) var(--sp-md)",background:"var(--bg-card)",borderRadius:"var(--r-md)",border:"1px solid var(--border)"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",fontWeight:600},children:new Date(a.recorded_date).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),null!==e&&(0,b.jsxs)("div",{style:{fontSize:"0.7rem",fontFamily:"var(--font-mono)",fontWeight:600,marginTop:"2px",color:e>=0?"var(--success)":"var(--error)"},children:[e>=0?"+":"","Â£",e.toLocaleString("en-GB",{minimumFractionDigits:2})]})]}),(0,b.jsxs)("div",{style:{fontFamily:"var(--font-mono)",fontWeight:700,fontSize:"0.9rem",color:"var(--text-primary)"},children:["Â£",a.balance.toLocaleString("en-GB",{minimumFractionDigits:2})]})]},c)})})]})]}):(0,b.jsx)("div",{className:"empty-state",children:(0,b.jsx)("div",{className:"empty-state-text",children:"Account not found"})})}function o(){let[a,e]=(0,c.useState)(null),[f,g]=(0,c.useState)("home"),[h,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(0);(0,c.useEffect)(()=>{v()},[]);let v=async()=>{try{let a=await fetch("/api/auth/session");if(a.ok){let b=await a.json();b.authenticated&&e(b.user)}}catch(a){console.error("Session check error:",a)}finally{o(!1)}},w=async()=>{await fetch("/api/auth/session",{method:"POST"}),e(null)},x=a=>{s(a)},y=()=>{s(null)};return h?(0,b.jsx)("div",{className:"app-shell",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100dvh"},children:(0,b.jsx)("div",{className:"skeleton",style:{width:"280px",height:"380px"}})}):a?(0,b.jsxs)("div",{className:"app-shell",children:[(0,b.jsxs)("div",{className:"app-header",children:[(0,b.jsxs)("div",{className:"header-user",children:[(0,b.jsx)("div",{className:"avatar",children:a.displayName?.charAt(0)||"U"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"header-greeting",children:"Welcome back"}),(0,b.jsx)("div",{className:"header-name",children:a.displayName})]})]}),(0,b.jsx)("div",{className:"header-actions",children:(0,b.jsx)("button",{className:"icon-btn",onClick:w,title:"Logout",children:(0,b.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),(0,b.jsx)("polyline",{points:"16 17 21 12 16 7"}),(0,b.jsx)("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})})]}),(0,b.jsxs)("div",{className:"app-content",children:["home"===f&&(0,b.jsx)(d,{onUpdateBalance:()=>q(!0),onAccountClick:x},t),"accounts"===f&&(0,b.jsx)(l,{onUpdate:()=>u(a=>a+1),onAccountClick:x},t),"history"===f&&(0,b.jsx)(j,{},t),"manage"===f&&(0,b.jsx)(k,{onUpdate:()=>u(a=>a+1)},t)]}),(0,b.jsxs)("nav",{className:"tab-bar",children:[(0,b.jsxs)("button",{className:`tab-item${"home"===f?" active":""}`,onClick:()=>g("home"),children:[(0,b.jsx)("span",{className:"tab-icon",children:(0,b.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),(0,b.jsx)("polyline",{points:"9 22 9 12 15 12 15 22"})]})}),"Home"]}),(0,b.jsxs)("button",{className:`tab-item${"accounts"===f?" active":""}`,onClick:()=>g("accounts"),children:[(0,b.jsx)("span",{className:"tab-icon",children:(0,b.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),(0,b.jsx)("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]})}),"Accounts"]}),(0,b.jsx)("button",{className:"tab-fab",onClick:()=>q(!0),title:"Update Balance",children:(0,b.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),(0,b.jsx)("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})}),(0,b.jsxs)("button",{className:`tab-item${"history"===f?" active":""}`,onClick:()=>g("history"),children:[(0,b.jsx)("span",{className:"tab-icon",children:(0,b.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,b.jsx)("polyline",{points:"12 6 12 12 16 14"})]})}),"History"]}),(0,b.jsxs)("button",{className:`tab-item${"manage"===f?" active":""}`,onClick:()=>g("manage"),children:[(0,b.jsx)("span",{className:"tab-icon",children:(0,b.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,b.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),"Settings"]})]}),p&&(0,b.jsx)("div",{className:"modal-overlay",onClick:a=>{a.target===a.currentTarget&&q(!1)},children:(0,b.jsxs)("div",{className:"modal-sheet",children:[(0,b.jsx)("div",{className:"modal-handle"}),(0,b.jsx)(m,{onSuccess:()=>{q(!1),u(a=>a+1)},currentUser:a})]})}),null!==r&&(0,b.jsx)("div",{className:"modal-overlay",onClick:a=>{a.target===a.currentTarget&&y()},children:(0,b.jsxs)("div",{className:"modal-sheet",children:[(0,b.jsx)("div",{className:"modal-handle"}),(0,b.jsx)(n,{accountId:r,currentUser:a,onClose:y,onUpdate:()=>{u(a=>a+1)}})]})})]}):(0,b.jsx)(i,{onLogin:e})}a.s(["default",()=>o],34911)}];

//# sourceMappingURL=Desktop_SavinGCs_9d643df1._.js.map