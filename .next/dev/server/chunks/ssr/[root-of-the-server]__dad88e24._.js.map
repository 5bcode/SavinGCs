{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/G/Desktop/SavinGCs/components/Dashboard.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface Account {\r\n    id: number;\r\n    pot_id: number;\r\n    account_name: string;\r\n    account_type: string;\r\n    owner: string;\r\n    current_balance: number;\r\n    pot_name: string;\r\n    pot_color: string;\r\n}\r\n\r\ninterface SavingsPot {\r\n    id: number;\r\n    name: string;\r\n    goal_amount: number | null;\r\n    color: string;\r\n    icon: string;\r\n    total_balance: number;\r\n}\r\n\r\ninterface DashboardProps {\r\n    onUpdateBalance: () => void;\r\n    onAccountClick: (accountId: number) => void;\r\n}\r\n\r\nexport default function Dashboard({ onUpdateBalance, onAccountClick }: DashboardProps) {\r\n    const [pots, setPots] = useState<SavingsPot[]>([]);\r\n    const [accounts, setAccounts] = useState<Account[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => { fetchData(); }, []);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            const [potsRes, accountsRes] = await Promise.all([fetch('/api/pots'), fetch('/api/accounts')]);\r\n            const potsData = await potsRes.json();\r\n            const accountsData = await accountsRes.json();\r\n            setPots(potsData.pots || []);\r\n            setAccounts(accountsData.accounts || []);\r\n        } catch (error) {\r\n            console.error('Error fetching data:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const totalSavings = pots.reduce((sum, pot) => sum + (pot.total_balance || 0), 0);\r\n    const totalGoal = pots.reduce((sum, pot) => sum + (pot.goal_amount || 0), 0);\r\n    const overallProgress = totalGoal > 0 ? (totalSavings / totalGoal) * 100 : 0;\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"stack\">\r\n                <div className=\"skeleton\" style={{ height: '220px' }} />\r\n                <div className=\"skeleton\" style={{ height: '100px' }} />\r\n                <div className=\"skeleton\" style={{ height: '80px' }} />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            {/* ‚îÄ‚îÄ‚îÄ Net Worth Hero ‚îÄ‚îÄ‚îÄ */}\r\n            <div style={{ textAlign: 'center', padding: 'var(--sp-lg) 0 var(--sp-md)' }}>\r\n                <div className=\"balance-label\">Total Net Worth</div>\r\n                <div className=\"balance-amount\">\r\n                    ¬£{totalSavings.toLocaleString('en-GB', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}\r\n                </div>\r\n                {totalGoal > 0 && (\r\n                    <div style={{ fontSize: '0.8rem', color: 'var(--text-tertiary)', marginTop: '6px' }}>\r\n                        {Math.min(overallProgress, 100).toFixed(1)}% of ¬£{totalGoal.toLocaleString('en-GB')} goal\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* ‚îÄ‚îÄ‚îÄ Overall Progress Ring Card ‚îÄ‚îÄ‚îÄ */}\r\n            {totalGoal > 0 && (\r\n                <div className=\"credit-card mb-lg\" style={{ position: 'relative' }}>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--sp-xl)', position: 'relative', zIndex: 1 }}>\r\n                        <ProgressRing percentage={Math.min(overallProgress, 100)} size={96} strokeWidth={7}>\r\n                            <div style={{ textAlign: 'center' }}>\r\n                                <div style={{ fontFamily: 'var(--font-mono)', fontSize: '1rem', fontWeight: 700, color: 'white', lineHeight: 1 }}>\r\n                                    {Math.min(overallProgress, 100).toFixed(0)}%\r\n                                </div>\r\n                                <div style={{ fontSize: '0.55rem', color: 'rgba(255,255,255,0.6)', marginTop: '2px' }}>\r\n                                    saved\r\n                                </div>\r\n                            </div>\r\n                        </ProgressRing>\r\n                        <div style={{ flex: 1 }}>\r\n                            <div style={{ fontSize: '0.7rem', fontWeight: 600, opacity: 0.7, letterSpacing: '0.1em', textTransform: 'uppercase', marginBottom: '4px' }}>\r\n                                Savings Progress\r\n                            </div>\r\n                            <div style={{ fontFamily: 'var(--font-mono)', fontSize: '1.4rem', fontWeight: 700, color: 'white' }}>\r\n                                ¬£{totalSavings.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                            </div>\r\n                            <div style={{ fontSize: '0.75rem', opacity: 0.6, marginTop: '4px' }}>\r\n                                ¬£{(totalGoal - totalSavings > 0 ? totalGoal - totalSavings : 0).toLocaleString('en-GB')} remaining\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    {/* Wave decoration */}\r\n                    <div className=\"wave-decoration\">\r\n                        <svg viewBox=\"0 0 400 80\" fill=\"none\" preserveAspectRatio=\"none\">\r\n                            <path d=\"M0 40 Q50 10 100 35 T200 30 T300 40 T400 25 L400 80 L0 80Z\" fill=\"rgba(13,148,136,0.3)\" />\r\n                            <path d=\"M0 50 Q60 25 120 45 T240 35 T360 50 T400 40 L400 80 L0 80Z\" fill=\"rgba(13,148,136,0.15)\" />\r\n                        </svg>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* ‚îÄ‚îÄ‚îÄ Actions Row ‚îÄ‚îÄ‚îÄ */}\r\n            <div className=\"flex gap-md mb-lg\">\r\n                <button className=\"btn btn-primary flex-1\" onClick={onUpdateBalance}>\r\n                    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                        <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"23\" /><path d=\"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\" />\r\n                    </svg>\r\n                    Update Balances\r\n                </button>\r\n                <div style={{ flex: 1 }}>\r\n                    <AllocateFunds\r\n                        pots={pots}\r\n                        accounts={accounts}\r\n                        onUpdate={onUpdateBalance}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {/* ‚îÄ‚îÄ‚îÄ Savings Pots Breakdown ‚îÄ‚îÄ‚îÄ */}\r\n            <div className=\"section-header\">\r\n                <div className=\"section-title\">Savings Pots</div>\r\n                <div className=\"section-link\">{pots.length} pot{pots.length !== 1 ? 's' : ''}</div>\r\n            </div>\r\n\r\n            {pots.length === 0 ? (\r\n                <div className=\"empty-state\">\r\n                    <div className=\"empty-state-icon\">üè°</div>\r\n                    <div className=\"empty-state-text\">\r\n                        No savings pots yet.<br />\r\n                        Go to Settings to create your first one!\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                <div className=\"stack mb-xl\">\r\n                    {pots.map((pot) => {\r\n                        const potAccounts = accounts.filter((a) => a.pot_id === pot.id);\r\n                        return <PotBreakdownCard key={pot.id} pot={pot} accounts={potAccounts} onAccountClick={onAccountClick} />;\r\n                    })}\r\n                </div>\r\n            )}\r\n\r\n            {/* ‚îÄ‚îÄ‚îÄ All Accounts Overview ‚îÄ‚îÄ‚îÄ */}\r\n            {accounts.length > 0 && (\r\n                <>\r\n                    <div className=\"section-header\">\r\n                        <div className=\"section-title\">All Accounts</div>\r\n                        <div className=\"section-link\">{accounts.length} account{accounts.length !== 1 ? 's' : ''}</div>\r\n                    </div>\r\n                    <div className=\"stack\" style={{ gap: 'var(--sp-sm)' }}>\r\n                        {accounts.map((account) => (\r\n                            <AccountBalanceRow key={account.id} account={account} onClick={() => onAccountClick(account.id)} />\r\n                        ))}\r\n                    </div>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n/* ‚îÄ‚îÄ‚îÄ Pot Breakdown Card ‚îÄ‚îÄ‚îÄ */\r\nfunction PotBreakdownCard({ pot, accounts, onAccountClick }: { pot: SavingsPot; accounts: Account[]; onAccountClick: (id: number) => void }) {\r\n    const progress = pot.goal_amount ? (pot.total_balance / pot.goal_amount) * 100 : 0;\r\n    const clampedProgress = Math.min(progress, 100);\r\n    const isGoalMet = pot.goal_amount && pot.total_balance >= pot.goal_amount;\r\n\r\n    return (\r\n        <div className=\"card\" style={{ padding: 'var(--sp-lg)' }}>\r\n            <div className=\"flex items-center justify-between mb-md\">\r\n                <div className=\"flex items-center gap-md\">\r\n                    <div className=\"pot-icon\" style={{ background: `${pot.color}25` }}>\r\n                        {getIcon(pot.icon)}\r\n                    </div>\r\n                    <div>\r\n                        <div style={{ fontWeight: 700, fontSize: '1rem' }}>{pot.name}</div>\r\n                        {pot.goal_amount && (\r\n                            <div style={{ fontSize: '0.75rem', color: 'var(--text-tertiary)', marginTop: '2px' }}>\r\n                                Goal: ¬£{pot.goal_amount.toLocaleString('en-GB')}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n                <div style={{ textAlign: 'right' }}>\r\n                    <div style={{ fontFamily: 'var(--font-mono)', fontWeight: 700, fontSize: '1.1rem', color: 'var(--text-primary)' }}>\r\n                        ¬£{pot.total_balance.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                    </div>\r\n                    {isGoalMet && (\r\n                        <div style={{ fontSize: '0.7rem', color: 'var(--success)', fontWeight: 600, marginTop: '2px' }}>‚úì Goal reached</div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {pot.goal_amount && (\r\n                <div>\r\n                    <div className=\"progress-track\" style={{ height: '8px', marginTop: 0, marginBottom: '6px' }}>\r\n                        <div\r\n                            className={`progress-fill${isGoalMet ? '' : ' purple'}`}\r\n                            style={{ width: `${clampedProgress}%` }}\r\n                        />\r\n                    </div>\r\n                    <div className=\"flex justify-between\" style={{ fontSize: '0.7rem', color: 'var(--text-tertiary)' }}>\r\n                        <span>{clampedProgress.toFixed(1)}% complete</span>\r\n                        <span>¬£{Math.max(0, (pot.goal_amount || 0) - pot.total_balance).toLocaleString('en-GB')} to go</span>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Inline account breakdown */}\r\n            {accounts.length > 0 && (\r\n                <div style={{ marginTop: 'var(--sp-md)', paddingTop: 'var(--sp-md)', borderTop: '1px solid var(--border)' }}>\r\n                    {accounts.map((acc) => (\r\n                        <div key={acc.id} className=\"flex justify-between items-center\" style={{ padding: '6px 0', cursor: 'pointer' }} onClick={() => onAccountClick(acc.id)}>\r\n                            <div className=\"flex items-center gap-sm\">\r\n                                <div style={{ width: '6px', height: '6px', borderRadius: '50%', background: pot.color, flexShrink: 0 }} />\r\n                                <span style={{ fontSize: '0.8rem', color: 'var(--text-secondary)' }}>{acc.account_name}</span>\r\n                                <span style={{ fontSize: '0.65rem', color: 'var(--text-tertiary)', padding: '1px 6px', background: 'var(--bg-secondary)', borderRadius: 'var(--r-sm)' }}>\r\n                                    {acc.account_type.toUpperCase()} ¬∑ {acc.owner || 'Joint'}\r\n                                </span>\r\n                            </div>\r\n                            <span style={{ fontFamily: 'var(--font-mono)', fontSize: '0.85rem', fontWeight: 600, color: 'var(--text-primary)' }}>\r\n                                ¬£{acc.current_balance.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                            </span>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n/* ‚îÄ‚îÄ‚îÄ Account Balance Row ‚îÄ‚îÄ‚îÄ */\r\nfunction AccountBalanceRow({ account, onClick }: { account: Account; onClick: () => void }) {\r\n    return (\r\n        <div className=\"pot-item\" onClick={onClick}>\r\n            <div className=\"pot-icon\" style={{\r\n                background: `linear-gradient(135deg, ${account.pot_color || 'var(--purple-start)'}30, ${account.pot_color || 'var(--purple-start)'}10)`,\r\n                fontSize: '1rem',\r\n            }}>\r\n                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={account.pot_color || 'var(--purple-mid)'} strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                    <rect x=\"1\" y=\"4\" width=\"22\" height=\"16\" rx=\"2\" ry=\"2\" /><line x1=\"1\" y1=\"10\" x2=\"23\" y2=\"10\" />\r\n                </svg>\r\n            </div>\r\n            <div className=\"pot-info\">\r\n                <div className=\"pot-name\">{account.account_name}</div>\r\n                <div className=\"pot-meta\">{account.pot_name} ¬∑ {account.account_type} ¬∑ {account.owner || 'Joint'}</div>\r\n            </div>\r\n            <div className=\"pot-amount\">\r\n                ¬£{account.current_balance.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n/* ‚îÄ‚îÄ‚îÄ Circular Progress Ring ‚îÄ‚îÄ‚îÄ */\r\nfunction ProgressRing({ percentage, size = 96, strokeWidth = 7, children }: {\r\n    percentage: number; size?: number; strokeWidth?: number; children?: React.ReactNode;\r\n}) {\r\n    const radius = (size - strokeWidth) / 2;\r\n    const circumference = radius * 2 * Math.PI;\r\n    const offset = circumference - (percentage / 100) * circumference;\r\n\r\n    return (\r\n        <div className=\"ring-container\" style={{ width: size, height: size }}>\r\n            <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\r\n                <circle className=\"ring-bg\" cx={size / 2} cy={size / 2} r={radius} />\r\n                <circle className=\"ring-fill\" cx={size / 2} cy={size / 2} r={radius}\r\n                    stroke=\"url(#ringGrad)\" strokeDasharray={circumference} strokeDashoffset={offset} />\r\n                <defs>\r\n                    <linearGradient id=\"ringGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                        <stop offset=\"0%\" stopColor=\"var(--purple-start)\" />\r\n                        <stop offset=\"100%\" stopColor=\"var(--teal-end)\" />\r\n                    </linearGradient>\r\n                </defs>\r\n            </svg>\r\n            <div className=\"ring-text\">{children}</div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction getIcon(icon: string) {\r\n    const icons: Record<string, string> = {\r\n        'piggy-bank': 'üê∑', 'house': 'üè°', 'car': 'üöó', 'vacation': 'üèñÔ∏è',\r\n        'emergency': 'üö®', 'wedding': 'üíç', 'education': 'üéì', 'savings': 'üí∞'\r\n    };\r\n    return icons[icon] || 'üí∞';\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AA6Be,SAAS,UAAU,EAAE,eAAe,EAAE,cAAc,EAAkB;IACjF,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,wOAAQ,EAAe,EAAE;IACjD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wOAAQ,EAAY,EAAE;IACtD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,wOAAQ,EAAC;IAEvC,IAAA,yOAAS,EAAC;QAAQ;IAAa,GAAG,EAAE;IAEpC,MAAM,YAAY;QACd,IAAI;YACA,MAAM,CAAC,SAAS,YAAY,GAAG,MAAM,QAAQ,GAAG,CAAC;gBAAC,MAAM;gBAAc,MAAM;aAAiB;YAC7F,MAAM,WAAW,MAAM,QAAQ,IAAI;YACnC,MAAM,eAAe,MAAM,YAAY,IAAI;YAC3C,QAAQ,SAAS,IAAI,IAAI,EAAE;YAC3B,YAAY,aAAa,QAAQ,IAAI,EAAE;QAC3C,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,wBAAwB;QAC1C,SAAU;YACN,WAAW;QACf;IACJ;IAEA,MAAM,eAAe,KAAK,MAAM,CAAC,CAAC,KAAK,MAAQ,MAAM,CAAC,IAAI,aAAa,IAAI,CAAC,GAAG;IAC/E,MAAM,YAAY,KAAK,MAAM,CAAC,CAAC,KAAK,MAAQ,MAAM,CAAC,IAAI,WAAW,IAAI,CAAC,GAAG;IAC1E,MAAM,kBAAkB,YAAY,IAAI,AAAC,eAAe,YAAa,MAAM;IAE3E,IAAI,SAAS;QACT,qBACI,qQAAC;YAAI,WAAU;;8BACX,qQAAC;oBAAI,WAAU;oBAAW,OAAO;wBAAE,QAAQ;oBAAQ;;;;;;8BACnD,qQAAC;oBAAI,WAAU;oBAAW,OAAO;wBAAE,QAAQ;oBAAQ;;;;;;8BACnD,qQAAC;oBAAI,WAAU;oBAAW,OAAO;wBAAE,QAAQ;oBAAO;;;;;;;;;;;;IAG9D;IAEA,qBACI,qQAAC;;0BAEG,qQAAC;gBAAI,OAAO;oBAAE,WAAW;oBAAU,SAAS;gBAA8B;;kCACtE,qQAAC;wBAAI,WAAU;kCAAgB;;;;;;kCAC/B,qQAAC;wBAAI,WAAU;;4BAAiB;4BAC1B,aAAa,cAAc,CAAC,SAAS;gCAAE,uBAAuB;gCAAG,uBAAuB;4BAAE;;;;;;;oBAE/F,YAAY,mBACT,qQAAC;wBAAI,OAAO;4BAAE,UAAU;4BAAU,OAAO;4BAAwB,WAAW;wBAAM;;4BAC7E,KAAK,GAAG,CAAC,iBAAiB,KAAK,OAAO,CAAC;4BAAG;4BAAO,UAAU,cAAc,CAAC;4BAAS;;;;;;;;;;;;;YAM/F,YAAY,mBACT,qQAAC;gBAAI,WAAU;gBAAoB,OAAO;oBAAE,UAAU;gBAAW;;kCAC7D,qQAAC;wBAAI,OAAO;4BAAE,SAAS;4BAAQ,YAAY;4BAAU,KAAK;4BAAgB,UAAU;4BAAY,QAAQ;wBAAE;;0CACtG,qQAAC;gCAAa,YAAY,KAAK,GAAG,CAAC,iBAAiB;gCAAM,MAAM;gCAAI,aAAa;0CAC7E,cAAA,qQAAC;oCAAI,OAAO;wCAAE,WAAW;oCAAS;;sDAC9B,qQAAC;4CAAI,OAAO;gDAAE,YAAY;gDAAoB,UAAU;gDAAQ,YAAY;gDAAK,OAAO;gDAAS,YAAY;4CAAE;;gDAC1G,KAAK,GAAG,CAAC,iBAAiB,KAAK,OAAO,CAAC;gDAAG;;;;;;;sDAE/C,qQAAC;4CAAI,OAAO;gDAAE,UAAU;gDAAW,OAAO;gDAAyB,WAAW;4CAAM;sDAAG;;;;;;;;;;;;;;;;;0CAK/F,qQAAC;gCAAI,OAAO;oCAAE,MAAM;gCAAE;;kDAClB,qQAAC;wCAAI,OAAO;4CAAE,UAAU;4CAAU,YAAY;4CAAK,SAAS;4CAAK,eAAe;4CAAS,eAAe;4CAAa,cAAc;wCAAM;kDAAG;;;;;;kDAG5I,qQAAC;wCAAI,OAAO;4CAAE,YAAY;4CAAoB,UAAU;4CAAU,YAAY;4CAAK,OAAO;wCAAQ;;4CAAG;4CAC/F,aAAa,cAAc,CAAC,SAAS;gDAAE,uBAAuB;4CAAE;;;;;;;kDAEtE,qQAAC;wCAAI,OAAO;4CAAE,UAAU;4CAAW,SAAS;4CAAK,WAAW;wCAAM;;4CAAG;4CAC/D,CAAC,YAAY,eAAe,IAAI,YAAY,eAAe,CAAC,EAAE,cAAc,CAAC;4CAAS;;;;;;;;;;;;;;;;;;;kCAKpG,qQAAC;wBAAI,WAAU;kCACX,cAAA,qQAAC;4BAAI,SAAQ;4BAAa,MAAK;4BAAO,qBAAoB;;8CACtD,qQAAC;oCAAK,GAAE;oCAA6D,MAAK;;;;;;8CAC1E,qQAAC;oCAAK,GAAE;oCAA6D,MAAK;;;;;;;;;;;;;;;;;;;;;;;0BAO1F,qQAAC;gBAAI,WAAU;;kCACX,qQAAC;wBAAO,WAAU;wBAAyB,SAAS;;0CAChD,qQAAC;gCAAI,OAAM;gCAAK,QAAO;gCAAK,SAAQ;gCAAY,MAAK;gCAAO,QAAO;gCAAe,aAAY;gCAAI,eAAc;gCAAQ,gBAAe;;kDACnI,qQAAC;wCAAK,IAAG;wCAAK,IAAG;wCAAI,IAAG;wCAAK,IAAG;;;;;;kDAAO,qQAAC;wCAAK,GAAE;;;;;;;;;;;;4BAC7C;;;;;;;kCAGV,qQAAC;wBAAI,OAAO;4BAAE,MAAM;wBAAE;kCAClB,cAAA,qQAAC;4BACG,MAAM;4BACN,UAAU;4BACV,UAAU;;;;;;;;;;;;;;;;;0BAMtB,qQAAC;gBAAI,WAAU;;kCACX,qQAAC;wBAAI,WAAU;kCAAgB;;;;;;kCAC/B,qQAAC;wBAAI,WAAU;;4BAAgB,KAAK,MAAM;4BAAC;4BAAK,KAAK,MAAM,KAAK,IAAI,MAAM;;;;;;;;;;;;;YAG7E,KAAK,MAAM,KAAK,kBACb,qQAAC;gBAAI,WAAU;;kCACX,qQAAC;wBAAI,WAAU;kCAAmB;;;;;;kCAClC,qQAAC;wBAAI,WAAU;;4BAAmB;0CACV,qQAAC;;;;;4BAAK;;;;;;;;;;;;qCAKlC,qQAAC;gBAAI,WAAU;0BACV,KAAK,GAAG,CAAC,CAAC;oBACP,MAAM,cAAc,SAAS,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK,IAAI,EAAE;oBAC9D,qBAAO,qQAAC;wBAA8B,KAAK;wBAAK,UAAU;wBAAa,gBAAgB;uBAAzD,IAAI,EAAE;;;;;gBACxC;;;;;;YAKP,SAAS,MAAM,GAAG,mBACf;;kCACI,qQAAC;wBAAI,WAAU;;0CACX,qQAAC;gCAAI,WAAU;0CAAgB;;;;;;0CAC/B,qQAAC;gCAAI,WAAU;;oCAAgB,SAAS,MAAM;oCAAC;oCAAS,SAAS,MAAM,KAAK,IAAI,MAAM;;;;;;;;;;;;;kCAE1F,qQAAC;wBAAI,WAAU;wBAAQ,OAAO;4BAAE,KAAK;wBAAe;kCAC/C,SAAS,GAAG,CAAC,CAAC,wBACX,qQAAC;gCAAmC,SAAS;gCAAS,SAAS,IAAM,eAAe,QAAQ,EAAE;+BAAtE,QAAQ,EAAE;;;;;;;;;;;;;;;;;;AAO9D;AAEA,8BAA8B,GAC9B,SAAS,iBAAiB,EAAE,GAAG,EAAE,QAAQ,EAAE,cAAc,EAAkF;IACvI,MAAM,WAAW,IAAI,WAAW,GAAG,AAAC,IAAI,aAAa,GAAG,IAAI,WAAW,GAAI,MAAM;IACjF,MAAM,kBAAkB,KAAK,GAAG,CAAC,UAAU;IAC3C,MAAM,YAAY,IAAI,WAAW,IAAI,IAAI,aAAa,IAAI,IAAI,WAAW;IAEzE,qBACI,qQAAC;QAAI,WAAU;QAAO,OAAO;YAAE,SAAS;QAAe;;0BACnD,qQAAC;gBAAI,WAAU;;kCACX,qQAAC;wBAAI,WAAU;;0CACX,qQAAC;gCAAI,WAAU;gCAAW,OAAO;oCAAE,YAAY,GAAG,IAAI,KAAK,CAAC,EAAE,CAAC;gCAAC;0CAC3D,QAAQ,IAAI,IAAI;;;;;;0CAErB,qQAAC;;kDACG,qQAAC;wCAAI,OAAO;4CAAE,YAAY;4CAAK,UAAU;wCAAO;kDAAI,IAAI,IAAI;;;;;;oCAC3D,IAAI,WAAW,kBACZ,qQAAC;wCAAI,OAAO;4CAAE,UAAU;4CAAW,OAAO;4CAAwB,WAAW;wCAAM;;4CAAG;4CAC1E,IAAI,WAAW,CAAC,cAAc,CAAC;;;;;;;;;;;;;;;;;;;kCAKvD,qQAAC;wBAAI,OAAO;4BAAE,WAAW;wBAAQ;;0CAC7B,qQAAC;gCAAI,OAAO;oCAAE,YAAY;oCAAoB,YAAY;oCAAK,UAAU;oCAAU,OAAO;gCAAsB;;oCAAG;oCAC7G,IAAI,aAAa,CAAC,cAAc,CAAC,SAAS;wCAAE,uBAAuB;oCAAE;;;;;;;4BAE1E,2BACG,qQAAC;gCAAI,OAAO;oCAAE,UAAU;oCAAU,OAAO;oCAAkB,YAAY;oCAAK,WAAW;gCAAM;0CAAG;;;;;;;;;;;;;;;;;;YAK3G,IAAI,WAAW,kBACZ,qQAAC;;kCACG,qQAAC;wBAAI,WAAU;wBAAiB,OAAO;4BAAE,QAAQ;4BAAO,WAAW;4BAAG,cAAc;wBAAM;kCACtF,cAAA,qQAAC;4BACG,WAAW,CAAC,aAAa,EAAE,YAAY,KAAK,WAAW;4BACvD,OAAO;gCAAE,OAAO,GAAG,gBAAgB,CAAC,CAAC;4BAAC;;;;;;;;;;;kCAG9C,qQAAC;wBAAI,WAAU;wBAAuB,OAAO;4BAAE,UAAU;4BAAU,OAAO;wBAAuB;;0CAC7F,qQAAC;;oCAAM,gBAAgB,OAAO,CAAC;oCAAG;;;;;;;0CAClC,qQAAC;;oCAAK;oCAAE,KAAK,GAAG,CAAC,GAAG,CAAC,IAAI,WAAW,IAAI,CAAC,IAAI,IAAI,aAAa,EAAE,cAAc,CAAC;oCAAS;;;;;;;;;;;;;;;;;;;YAMnG,SAAS,MAAM,GAAG,mBACf,qQAAC;gBAAI,OAAO;oBAAE,WAAW;oBAAgB,YAAY;oBAAgB,WAAW;gBAA0B;0BACrG,SAAS,GAAG,CAAC,CAAC,oBACX,qQAAC;wBAAiB,WAAU;wBAAoC,OAAO;4BAAE,SAAS;4BAAS,QAAQ;wBAAU;wBAAG,SAAS,IAAM,eAAe,IAAI,EAAE;;0CAChJ,qQAAC;gCAAI,WAAU;;kDACX,qQAAC;wCAAI,OAAO;4CAAE,OAAO;4CAAO,QAAQ;4CAAO,cAAc;4CAAO,YAAY,IAAI,KAAK;4CAAE,YAAY;wCAAE;;;;;;kDACrG,qQAAC;wCAAK,OAAO;4CAAE,UAAU;4CAAU,OAAO;wCAAwB;kDAAI,IAAI,YAAY;;;;;;kDACtF,qQAAC;wCAAK,OAAO;4CAAE,UAAU;4CAAW,OAAO;4CAAwB,SAAS;4CAAW,YAAY;4CAAuB,cAAc;wCAAc;;4CACjJ,IAAI,YAAY,CAAC,WAAW;4CAAG;4CAAI,IAAI,KAAK,IAAI;;;;;;;;;;;;;0CAGzD,qQAAC;gCAAK,OAAO;oCAAE,YAAY;oCAAoB,UAAU;oCAAW,YAAY;oCAAK,OAAO;gCAAsB;;oCAAG;oCAC/G,IAAI,eAAe,CAAC,cAAc,CAAC,SAAS;wCAAE,uBAAuB;oCAAE;;;;;;;;uBATvE,IAAI,EAAE;;;;;;;;;;;;;;;;AAiBxC;AAEA,+BAA+B,GAC/B,SAAS,kBAAkB,EAAE,OAAO,EAAE,OAAO,EAA6C;IACtF,qBACI,qQAAC;QAAI,WAAU;QAAW,SAAS;;0BAC/B,qQAAC;gBAAI,WAAU;gBAAW,OAAO;oBAC7B,YAAY,CAAC,wBAAwB,EAAE,QAAQ,SAAS,IAAI,sBAAsB,IAAI,EAAE,QAAQ,SAAS,IAAI,sBAAsB,GAAG,CAAC;oBACvI,UAAU;gBACd;0BACI,cAAA,qQAAC;oBAAI,OAAM;oBAAK,QAAO;oBAAK,SAAQ;oBAAY,MAAK;oBAAO,QAAQ,QAAQ,SAAS,IAAI;oBAAqB,aAAY;oBAAI,eAAc;oBAAQ,gBAAe;;sCAC/J,qQAAC;4BAAK,GAAE;4BAAI,GAAE;4BAAI,OAAM;4BAAK,QAAO;4BAAK,IAAG;4BAAI,IAAG;;;;;;sCAAM,qQAAC;4BAAK,IAAG;4BAAI,IAAG;4BAAK,IAAG;4BAAK,IAAG;;;;;;;;;;;;;;;;;0BAGjG,qQAAC;gBAAI,WAAU;;kCACX,qQAAC;wBAAI,WAAU;kCAAY,QAAQ,YAAY;;;;;;kCAC/C,qQAAC;wBAAI,WAAU;;4BAAY,QAAQ,QAAQ;4BAAC;4BAAI,QAAQ,YAAY;4BAAC;4BAAI,QAAQ,KAAK,IAAI;;;;;;;;;;;;;0BAE9F,qQAAC;gBAAI,WAAU;;oBAAa;oBACtB,QAAQ,eAAe,CAAC,cAAc,CAAC,SAAS;wBAAE,uBAAuB;oBAAE;;;;;;;;;;;;;AAI7F;AAEA,kCAAkC,GAClC,SAAS,aAAa,EAAE,UAAU,EAAE,OAAO,EAAE,EAAE,cAAc,CAAC,EAAE,QAAQ,EAEvE;IACG,MAAM,SAAS,CAAC,OAAO,WAAW,IAAI;IACtC,MAAM,gBAAgB,SAAS,IAAI,KAAK,EAAE;IAC1C,MAAM,SAAS,gBAAgB,AAAC,aAAa,MAAO;IAEpD,qBACI,qQAAC;QAAI,WAAU;QAAiB,OAAO;YAAE,OAAO;YAAM,QAAQ;QAAK;;0BAC/D,qQAAC;gBAAI,OAAO;gBAAM,QAAQ;gBAAM,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,MAAM;;kCAC1D,qQAAC;wBAAO,WAAU;wBAAU,IAAI,OAAO;wBAAG,IAAI,OAAO;wBAAG,GAAG;;;;;;kCAC3D,qQAAC;wBAAO,WAAU;wBAAY,IAAI,OAAO;wBAAG,IAAI,OAAO;wBAAG,GAAG;wBACzD,QAAO;wBAAiB,iBAAiB;wBAAe,kBAAkB;;;;;;kCAC9E,qQAAC;kCACG,cAAA,qQAAC;4BAAe,IAAG;4BAAW,IAAG;4BAAK,IAAG;4BAAK,IAAG;4BAAO,IAAG;;8CACvD,qQAAC;oCAAK,QAAO;oCAAK,WAAU;;;;;;8CAC5B,qQAAC;oCAAK,QAAO;oCAAO,WAAU;;;;;;;;;;;;;;;;;;;;;;;0BAI1C,qQAAC;gBAAI,WAAU;0BAAa;;;;;;;;;;;;AAGxC;AAEA,SAAS,QAAQ,IAAY;IACzB,MAAM,QAAgC;QAClC,cAAc;QAAM,SAAS;QAAM,OAAO;QAAM,YAAY;QAC5D,aAAa;QAAM,WAAW;QAAM,aAAa;QAAM,WAAW;IACtE;IACA,OAAO,KAAK,CAAC,KAAK,IAAI;AAC1B"}},
    {"offset": {"line": 1015, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/G/Desktop/SavinGCs/components/Login.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\n\r\ninterface LoginProps {\r\n    onLogin: (user: any) => void;\r\n}\r\n\r\nexport default function Login({ onLogin }: LoginProps) {\r\n    const [username, setUsername] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [rememberMe, setRememberMe] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setLoading(true);\r\n\r\n        try {\r\n            const res = await fetch('/api/auth/login', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ username, password, rememberMe })\r\n            });\r\n\r\n            const data = await res.json();\r\n            if (!res.ok) { setError(data.error || 'Login failed'); return; }\r\n            onLogin(data.user);\r\n        } catch (err) {\r\n            setError('An error occurred. Please try again.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"login-page\">\r\n            <div className=\"login-card\">\r\n                <div className=\"login-brand\">\r\n                    <div className=\"login-logo\">üè°</div>\r\n                    <h1 className=\"login-title\">SavinGCs</h1>\r\n                    <p className=\"login-subtitle\">Track your savings together</p>\r\n                </div>\r\n\r\n                <form onSubmit={handleSubmit} className=\"card-glass\">\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\" htmlFor=\"username\">Username</label>\r\n                        <input\r\n                            id=\"username\"\r\n                            type=\"text\"\r\n                            className=\"form-input\"\r\n                            value={username}\r\n                            onChange={(e) => setUsername(e.target.value)}\r\n                            placeholder=\"Enter username\"\r\n                            required\r\n                            autoComplete=\"username\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\" htmlFor=\"password\">Password</label>\r\n                        <input\r\n                            id=\"password\"\r\n                            type=\"password\"\r\n                            className=\"form-input\"\r\n                            value={password}\r\n                            onChange={(e) => setPassword(e.target.value)}\r\n                            placeholder=\"Enter password\"\r\n                            required\r\n                            autoComplete=\"current-password\"\r\n                        />\r\n                    </div>\r\n\r\n                    <label style={{\r\n                        display: 'flex',\r\n                        alignItems: 'center',\r\n                        gap: 'var(--sp-sm)',\r\n                        cursor: 'pointer',\r\n                        marginBottom: 'var(--sp-lg)',\r\n                        WebkitTapHighlightColor: 'transparent',\r\n                    }}>\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            checked={rememberMe}\r\n                            onChange={(e) => setRememberMe(e.target.checked)}\r\n                            style={{\r\n                                width: '18px',\r\n                                height: '18px',\r\n                                accentColor: 'var(--purple-start)',\r\n                                cursor: 'pointer',\r\n                            }}\r\n                        />\r\n                        <span style={{ fontSize: '0.85rem', color: 'var(--text-secondary)' }}>\r\n                            Remember me\r\n                        </span>\r\n                    </label>\r\n\r\n                    {error && <div className=\"error-badge\">{error}</div>}\r\n\r\n                    <button type=\"submit\" className=\"btn btn-primary\" style={{ width: '100%' }} disabled={loading}>\r\n                        {loading ? (\r\n                            <span style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" style={{ animation: 'spin 1s linear infinite' }}>\r\n                                    <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"3\" fill=\"none\" strokeDasharray=\"60 30\" />\r\n                                </svg>\r\n                                Signing in...\r\n                            </span>\r\n                        ) : 'Sign In'}\r\n                    </button>\r\n                </form>\r\n            </div>\r\n\r\n            <style jsx>{`\r\n        @keyframes spin {\r\n          from { transform: rotate(0deg); }\r\n          to { transform: rotate(360deg); }\r\n        }\r\n      `}</style>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;;AAEA;AAFA;;;;AAQe,SAAS,MAAM,EAAE,OAAO,EAAc;IACjD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wOAAQ,EAAC;IACzC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wOAAQ,EAAC;IACzC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,wOAAQ,EAAC;IAC7C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,wOAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,wOAAQ,EAAC;IAEvC,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,SAAS;QACT,WAAW;QAEX,IAAI;YACA,MAAM,MAAM,MAAM,MAAM,mBAAmB;gBACvC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAU;oBAAU;gBAAW;YAC1D;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;gBAAE,SAAS,KAAK,KAAK,IAAI;gBAAiB;YAAQ;YAC/D,QAAQ,KAAK,IAAI;QACrB,EAAE,OAAO,KAAK;YACV,SAAS;QACb,SAAU;YACN,WAAW;QACf;IACJ;IAEA,qBACI,qQAAC;kDAAc;;0BACX,qQAAC;0DAAc;;kCACX,qQAAC;kEAAc;;0CACX,qQAAC;0EAAc;0CAAa;;;;;;0CAC5B,qQAAC;0EAAa;0CAAc;;;;;;0CAC5B,qQAAC;0EAAY;0CAAiB;;;;;;;;;;;;kCAGlC,qQAAC;wBAAK,UAAU;kEAAwB;;0CACpC,qQAAC;0EAAc;;kDACX,qQAAC;wCAA6B,SAAQ;kFAArB;kDAAgC;;;;;;kDACjD,qQAAC;wCACG,IAAG;wCACH,MAAK;wCAEL,OAAO;wCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;wCAC3C,aAAY;wCACZ,QAAQ;wCACR,cAAa;kFALH;;;;;;;;;;;;0CASlB,qQAAC;0EAAc;;kDACX,qQAAC;wCAA6B,SAAQ;kFAArB;kDAAgC;;;;;;kDACjD,qQAAC;wCACG,IAAG;wCACH,MAAK;wCAEL,OAAO;wCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;wCAC3C,aAAY;wCACZ,QAAQ;wCACR,cAAa;kFALH;;;;;;;;;;;;0CASlB,qQAAC;gCAAM,OAAO;oCACV,SAAS;oCACT,YAAY;oCACZ,KAAK;oCACL,QAAQ;oCACR,cAAc;oCACd,yBAAyB;gCAC7B;;;kDACI,qQAAC;wCACG,MAAK;wCACL,SAAS;wCACT,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,OAAO;wCAC/C,OAAO;4CACH,OAAO;4CACP,QAAQ;4CACR,aAAa;4CACb,QAAQ;wCACZ;;;;;;;kDAEJ,qQAAC;wCAAK,OAAO;4CAAE,UAAU;4CAAW,OAAO;wCAAwB;;kDAAG;;;;;;;;;;;;4BAKzE,uBAAS,qQAAC;0EAAc;0CAAe;;;;;;0CAExC,qQAAC;gCAAO,MAAK;gCAAqC,OAAO;oCAAE,OAAO;gCAAO;gCAAG,UAAU;0EAAtD;0CAC3B,wBACG,qQAAC;oCAAK,OAAO;wCAAE,SAAS;wCAAQ,YAAY;wCAAU,KAAK;oCAAM;;;sDAC7D,qQAAC;4CAAI,OAAM;4CAAK,QAAO;4CAAK,SAAQ;4CAAY,OAAO;gDAAE,WAAW;4CAA0B;;sDAC1F,cAAA,qQAAC;gDAAO,IAAG;gDAAK,IAAG;gDAAK,GAAE;gDAAK,QAAO;gDAAe,aAAY;gDAAI,MAAK;gDAAO,iBAAgB;;;;;;;;;;;;wCAC/F;;;;;;2CAGV;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAa5B"}},
    {"offset": {"line": 1301, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/G/Desktop/SavinGCs/components/SpreadsheetView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface Transaction {\r\n    id: number;\r\n    account_name: string;\r\n    pot_name: string;\r\n    user_name: string;\r\n    amount: number;\r\n    description: string;\r\n    transaction_date: string;\r\n}\r\n\r\nexport default function SpreadsheetView() {\r\n    const [transactions, setTransactions] = useState<Transaction[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => { fetchTransactions(); }, []);\r\n\r\n    const fetchTransactions = async () => {\r\n        try {\r\n            const res = await fetch('/api/transactions');\r\n            const data = await res.json();\r\n            setTransactions(data.transactions || []);\r\n        } catch (error) {\r\n            console.error('Error fetching transactions:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleExport = async () => {\r\n        try {\r\n            const res = await fetch('/api/export/csv');\r\n            const blob = await res.blob();\r\n            const url = window.URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            a.download = `savings-${new Date().toISOString().split('T')[0]}.csv`;\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            window.URL.revokeObjectURL(url);\r\n            document.body.removeChild(a);\r\n        } catch (error) {\r\n            console.error('Export error:', error);\r\n        }\r\n    };\r\n\r\n    if (loading) return <div className=\"skeleton\" style={{ height: '300px' }} />;\r\n\r\n    // Group transactions by date\r\n    const grouped: Record<string, Transaction[]> = {};\r\n    transactions.forEach((tx) => {\r\n        const dateKey = new Date(tx.transaction_date).toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });\r\n        if (!grouped[dateKey]) grouped[dateKey] = [];\r\n        grouped[dateKey].push(tx);\r\n    });\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"section-header\">\r\n                <div className=\"section-title\">Balance History</div>\r\n                <button className=\"btn btn-secondary\" style={{ padding: '8px 14px', minHeight: 'auto', fontSize: '0.75rem' }} onClick={handleExport}>\r\n                    <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                        <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" /><polyline points=\"7 10 12 15 17 10\" /><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\r\n                    </svg>\r\n                    Export\r\n                </button>\r\n            </div>\r\n\r\n            <p style={{ fontSize: '0.8rem', color: 'var(--text-tertiary)', marginBottom: 'var(--sp-lg)' }}>\r\n                A log of all balance changes across your accounts.\r\n            </p>\r\n\r\n            {transactions.length === 0 ? (\r\n                <div className=\"empty-state\">\r\n                    <div className=\"empty-state-icon\">üìã</div>\r\n                    <div className=\"empty-state-text\">No history yet.<br />Balance changes will appear here.</div>\r\n                </div>\r\n            ) : (\r\n                Object.entries(grouped).map(([dateLabel, dateTxs]) => (\r\n                    <div key={dateLabel} style={{ marginBottom: 'var(--sp-xl)' }}>\r\n                        <div style={{ fontSize: '0.7rem', fontWeight: 700, color: 'var(--text-tertiary)', textTransform: 'uppercase', letterSpacing: '0.08em', marginBottom: 'var(--sp-sm)', padding: '0 2px' }}>\r\n                            {dateLabel}\r\n                        </div>\r\n                        <div className=\"stack\" style={{ gap: 'var(--sp-xs)' }}>\r\n                            {dateTxs.map((tx) => (\r\n                                <div key={tx.id} className=\"pot-item\" style={{ cursor: 'default', padding: 'var(--sp-sm) var(--sp-md)' }}>\r\n                                    <div style={{\r\n                                        width: '36px', height: '36px', borderRadius: 'var(--r-md)',\r\n                                        display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0, fontSize: '1rem',\r\n                                        background: tx.amount >= 0\r\n                                            ? 'linear-gradient(135deg, rgba(52, 211, 153, 0.15), rgba(52, 211, 153, 0.05))'\r\n                                            : 'linear-gradient(135deg, rgba(248, 113, 113, 0.15), rgba(248, 113, 113, 0.05))',\r\n                                    }}>\r\n                                        {tx.amount >= 0 ? '‚Üó' : '‚Üô'}\r\n                                    </div>\r\n                                    <div className=\"pot-info\">\r\n                                        <div style={{ fontWeight: 600, fontSize: '0.85rem' }}>{tx.account_name}</div>\r\n                                        <div style={{ fontSize: '0.7rem', color: 'var(--text-tertiary)' }}>\r\n                                            {tx.description || tx.pot_name} ‚Ä¢ {tx.user_name}\r\n                                        </div>\r\n                                    </div>\r\n                                    <span style={{\r\n                                        fontFamily: 'var(--font-mono)', fontWeight: 700, fontSize: '0.9rem',\r\n                                        color: tx.amount >= 0 ? 'var(--success)' : 'var(--error)'\r\n                                    }}>\r\n                                        {tx.amount >= 0 ? '+' : ''}¬£{Math.abs(tx.amount).toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                                    </span>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                ))\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1616, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/G/Desktop/SavinGCs/components/ManagePots.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface SavingsPot {\r\n    id: number;\r\n    name: string;\r\n    goal_amount: number | null;\r\n    color: string;\r\n    icon: string;\r\n}\r\n\r\ninterface ManagePotsProps {\r\n    onUpdate: () => void;\r\n}\r\n\r\nexport default function ManagePots({ onUpdate }: ManagePotsProps) {\r\n    const [pots, setPots] = useState<SavingsPot[]>([]);\r\n    const [showForm, setShowForm] = useState(false);\r\n    const [formData, setFormData] = useState({ name: '', goalAmount: '', color: '#7B2FE0', icon: 'piggy-bank' });\r\n\r\n    useEffect(() => { fetchPots(); }, []);\r\n\r\n    const fetchPots = async () => {\r\n        try {\r\n            const res = await fetch('/api/pots');\r\n            const data = await res.json();\r\n            setPots(data.pots || []);\r\n        } catch (error) { console.error('Error fetching pots:', error); }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        try {\r\n            const res = await fetch('/api/pots', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    name: formData.name,\r\n                    goalAmount: formData.goalAmount ? parseFloat(formData.goalAmount) : null,\r\n                    color: formData.color,\r\n                    icon: formData.icon,\r\n                    priority: 0\r\n                })\r\n            });\r\n            if (!res.ok) throw new Error('Failed to create pot');\r\n            setFormData({ name: '', goalAmount: '', color: '#7B2FE0', icon: 'piggy-bank' });\r\n            setShowForm(false);\r\n            fetchPots();\r\n            onUpdate();\r\n        } catch (error) {\r\n            console.error('Error creating pot:', error);\r\n            alert('Failed to create savings pot');\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (id: number) => {\r\n        if (!confirm('Delete this pot and all its accounts/transactions?')) return;\r\n        try {\r\n            const res = await fetch(`/api/pots/${id}`, { method: 'DELETE' });\r\n            if (!res.ok) throw new Error('Failed to delete pot');\r\n            fetchPots();\r\n            onUpdate();\r\n        } catch (error) { console.error('Error deleting pot:', error); alert('Failed to delete pot'); }\r\n    };\r\n\r\n    const iconPairs: [string, string][] = [\r\n        ['house', 'üè°'],\r\n        ['piggy-bank', 'üê∑'],\r\n        ['car', 'üöó'],\r\n        ['vacation', 'üèñÔ∏è'],\r\n        ['emergency', 'üö®'],\r\n        ['wedding', 'üíç'],\r\n        ['education', 'üéì'],\r\n        ['savings', 'üí∞'],\r\n    ];\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"section-header\">\r\n                <div className=\"section-title\">Savings Pots</div>\r\n                <button className=\"btn btn-primary\" style={{ padding: '8px 16px', minHeight: 'auto', fontSize: '0.8rem' }} onClick={() => setShowForm(!showForm)}>\r\n                    {showForm ? 'Cancel' : '+ New Pot'}\r\n                </button>\r\n            </div>\r\n\r\n            {showForm && (\r\n                <form onSubmit={handleSubmit} className=\"card mb-lg\">\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Pot Name</label>\r\n                        <input type=\"text\" className=\"form-input\" value={formData.name}\r\n                            onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                            placeholder=\"e.g., House Deposit\" required />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Goal Amount (¬£)</label>\r\n                        <input type=\"number\" step=\"0.01\" className=\"form-input\" value={formData.goalAmount}\r\n                            onChange={(e) => setFormData({ ...formData, goalAmount: e.target.value })}\r\n                            placeholder=\"Optional - e.g., 50000\" />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Icon</label>\r\n                        <div className=\"flex gap-sm\" style={{ flexWrap: 'wrap' }}>\r\n                            {iconPairs.map(([key, emoji]) => (\r\n                                <button key={key} type=\"button\"\r\n                                    onClick={() => setFormData({ ...formData, icon: key })}\r\n                                    style={{\r\n                                        width: '44px', height: '44px', borderRadius: 'var(--r-md)',\r\n                                        background: formData.icon === key ? 'var(--purple-start)' : 'var(--bg-secondary)',\r\n                                        border: formData.icon === key ? '2px solid var(--purple-mid)' : '1px solid var(--border)',\r\n                                        fontSize: '1.2rem', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n                                        transition: 'all var(--t-fast)'\r\n                                    }}>{emoji}</button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Color</label>\r\n                        <div className=\"flex gap-sm\">\r\n                            {['#7B2FE0', '#059669', '#f59e0b', '#ef4444', '#3b82f6', '#ec4899', '#8b5cf6'].map((c) => (\r\n                                <button key={c} type=\"button\" onClick={() => setFormData({ ...formData, color: c })}\r\n                                    style={{\r\n                                        width: '36px', height: '36px', borderRadius: 'var(--r-full)', background: c,\r\n                                        border: formData.color === c ? '3px solid white' : '2px solid transparent',\r\n                                        cursor: 'pointer', transition: 'all var(--t-fast)'\r\n                                    }} />\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                    <button type=\"submit\" className=\"btn btn-teal\" style={{ width: '100%' }}>Create Pot</button>\r\n                </form>\r\n            )}\r\n\r\n            <div className=\"stack\" style={{ gap: 'var(--sp-sm)' }}>\r\n                {pots.map((pot) => {\r\n                    const isUnallocated = pot.name === 'Unallocated';\r\n                    return (\r\n                        <div key={pot.id} className=\"pot-item\">\r\n                            <div className=\"pot-icon\" style={{ background: `${pot.color}30`, fontSize: '1.3rem' }}>\r\n                                {iconPairs.find(([k]) => k === pot.icon)?.[1] || 'üí∞'}\r\n                            </div>\r\n                            <div className=\"pot-info\">\r\n                                <div className=\"pot-name\">{pot.name}</div>\r\n                                {isUnallocated ? (\r\n                                    <div className=\"pot-meta\">Default ¬∑ Cannot be deleted</div>\r\n                                ) : pot.goal_amount ? (\r\n                                    <div className=\"pot-meta\">Goal: ¬£{pot.goal_amount.toLocaleString('en-GB')}</div>\r\n                                ) : null}\r\n                            </div>\r\n                            {!isUnallocated && (\r\n                                <button onClick={() => handleDelete(pot.id)} className=\"icon-btn\" style={{ color: 'var(--error)' }}>\r\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                        <polyline points=\"3 6 5 6 21 6\" /><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\r\n                                    </svg>\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2069, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/G/Desktop/SavinGCs/components/ManageAccounts.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface Account {\r\n    id: number;\r\n    pot_id: number;\r\n    pot_name: string;\r\n    pot_color: string;\r\n    account_name: string;\r\n    account_type: string;\r\n    owner: string;\r\n    current_balance: number;\r\n}\r\n\r\ninterface SavingsPot {\r\n    id: number;\r\n    name: string;\r\n    color: string;\r\n}\r\n\r\ninterface ManageAccountsProps {\r\n    onUpdate: () => void;\r\n    onAccountClick: (accountId: number) => void;\r\n}\r\n\r\nexport default function ManageAccounts({ onUpdate, onAccountClick }: ManageAccountsProps) {\r\n    const [accounts, setAccounts] = useState<Account[]>([]);\r\n    const [pots, setPots] = useState<SavingsPot[]>([]);\r\n    const [showForm, setShowForm] = useState(false);\r\n    const [formData, setFormData] = useState({ potId: '', accountName: '', accountType: 'savings', owner: 'Joint', currentBalance: '' });\r\n\r\n    useEffect(() => { fetchData(); }, []);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            const [accountsRes, potsRes] = await Promise.all([fetch('/api/accounts'), fetch('/api/pots')]);\r\n            const accountsData = await accountsRes.json();\r\n            const potsData = await potsRes.json();\r\n            const fetchedPots = potsData.pots || [];\r\n            setAccounts(accountsData.accounts || []);\r\n            setPots(fetchedPots);\r\n            // Default pot selection to Unallocated if not yet set\r\n            if (!formData.potId) {\r\n                const unallocated = fetchedPots.find((p: SavingsPot) => p.name === 'Unallocated');\r\n                if (unallocated) setFormData(prev => ({ ...prev, potId: String(unallocated.id) }));\r\n            }\r\n        } catch (error) { console.error('Error fetching data:', error); }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        try {\r\n            const res = await fetch('/api/accounts', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    potId: parseInt(formData.potId),\r\n                    accountName: formData.accountName,\r\n                    accountType: formData.accountType,\r\n                    owner: formData.owner,\r\n                    currentBalance: parseFloat(formData.currentBalance) || 0\r\n                })\r\n            });\r\n            if (!res.ok) throw new Error('Failed to create account');\r\n            setFormData({ potId: '', accountName: '', accountType: 'savings', owner: 'Joint', currentBalance: '' });\r\n            setShowForm(false);\r\n            fetchData();\r\n            onUpdate();\r\n        } catch (error) { console.error('Error creating account:', error); alert('Failed to create account'); }\r\n    };\r\n\r\n    const handleDelete = async (id: number) => {\r\n        if (!confirm('Delete this account and all its transactions?')) return;\r\n        try {\r\n            const res = await fetch(`/api/accounts/${id}`, { method: 'DELETE' });\r\n            if (!res.ok) throw new Error('Failed to delete account');\r\n            fetchData();\r\n            onUpdate();\r\n        } catch (error) { console.error('Error deleting account:', error); alert('Failed to delete account'); }\r\n    };\r\n\r\n    const typeLabels: Record<string, string> = {\r\n        savings: 'Savings', isa: 'ISA', current: 'Current', investment: 'Investment', other: 'Other'\r\n    };\r\n\r\n    // Group by pot\r\n    const grouped: Record<string, { color: string; accounts: Account[] }> = {};\r\n    accounts.forEach((acc) => {\r\n        if (!grouped[acc.pot_name]) grouped[acc.pot_name] = { color: acc.pot_color, accounts: [] };\r\n        grouped[acc.pot_name].accounts.push(acc);\r\n    });\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"section-header\">\r\n                <div className=\"section-title\">Your Accounts</div>\r\n                <button className=\"btn btn-primary\" style={{ padding: '8px 16px', minHeight: 'auto', fontSize: '0.8rem' }} onClick={() => setShowForm(!showForm)}>\r\n                    {showForm ? 'Cancel' : '+ Add Account'}\r\n                </button>\r\n            </div>\r\n\r\n            <p style={{ fontSize: '0.8rem', color: 'var(--text-tertiary)', marginBottom: 'var(--sp-lg)' }}>\r\n                All your savings accounts, grouped by pot.\r\n            </p>\r\n\r\n            {showForm && (\r\n                <form onSubmit={handleSubmit} className=\"card mb-lg\">\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Savings Pot</label>\r\n                        <select className=\"form-select\" value={formData.potId}\r\n                            onChange={(e) => setFormData({ ...formData, potId: e.target.value })} required>\r\n                            {pots.map((pot) => (\r\n                                <option key={pot.id} value={pot.id}>{pot.name}</option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Account Name</label>\r\n                        <input type=\"text\" className=\"form-input\" value={formData.accountName}\r\n                            onChange={(e) => setFormData({ ...formData, accountName: e.target.value })}\r\n                            placeholder=\"e.g., HSBC Lifetime ISA\" required />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Account Type</label>\r\n                        <select className=\"form-select\" value={formData.accountType}\r\n                            onChange={(e) => setFormData({ ...formData, accountType: e.target.value })}>\r\n                            <option value=\"savings\">Savings Account</option>\r\n                            <option value=\"isa\">ISA</option>\r\n                            <option value=\"current\">Current Account</option>\r\n                            <option value=\"investment\">Investment Account</option>\r\n                            <option value=\"other\">Other</option>\r\n                        </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Owner</label>\r\n                        <select className=\"form-select\" value={formData.owner}\r\n                            onChange={(e) => setFormData({ ...formData, owner: e.target.value })}>\r\n                            <option value=\"Gary\">Gary</option>\r\n                            <option value=\"Catherine\">Catherine</option>\r\n                            <option value=\"Joint\">Joint</option>\r\n                        </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Current Balance (¬£)</label>\r\n                        <input type=\"number\" step=\"0.01\" className=\"form-input\" value={formData.currentBalance}\r\n                            onChange={(e) => setFormData({ ...formData, currentBalance: e.target.value })}\r\n                            placeholder=\"0.00\" style={{ fontFamily: 'var(--font-mono)' }} />\r\n                    </div>\r\n                    <button type=\"submit\" className=\"btn btn-teal\" style={{ width: '100%' }}>Add Account</button>\r\n                </form>\r\n            )}\r\n\r\n            {Object.keys(grouped).length === 0 && !showForm && (\r\n                <div className=\"empty-state\">\r\n                    <div className=\"empty-state-icon\">üè¶</div>\r\n                    <div className=\"empty-state-text\">No accounts yet.<br />Add your first bank account above!</div>\r\n                </div>\r\n            )}\r\n\r\n            {Object.entries(grouped).map(([potName, group]) => {\r\n                const potTotal = group.accounts.reduce((sum, a) => sum + a.current_balance, 0);\r\n                return (\r\n                    <div key={potName} style={{ marginBottom: 'var(--sp-xl)' }}>\r\n                        <div className=\"flex justify-between items-center\" style={{ marginBottom: 'var(--sp-sm)', padding: '0 2px' }}>\r\n                            <div className=\"flex items-center gap-sm\">\r\n                                <div style={{ width: '8px', height: '8px', borderRadius: '50%', background: group.color }} />\r\n                                <span style={{ fontSize: '0.75rem', fontWeight: 700, color: 'var(--text-tertiary)', textTransform: 'uppercase', letterSpacing: '0.08em' }}>\r\n                                    {potName}\r\n                                </span>\r\n                            </div>\r\n                            <span style={{ fontSize: '0.8rem', fontFamily: 'var(--font-mono)', fontWeight: 600, color: 'var(--text-secondary)' }}>\r\n                                ¬£{potTotal.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"stack\" style={{ gap: 'var(--sp-xs)' }}>\r\n                            {group.accounts.map((account) => (\r\n                                <div key={account.id} className=\"pot-item\" onClick={() => onAccountClick(account.id)}>\r\n                                    <div className=\"pot-icon\" style={{\r\n                                        background: `linear-gradient(135deg, ${account.pot_color}30, ${account.pot_color}10)`,\r\n                                        fontSize: '1rem',\r\n                                    }}>\r\n                                        <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={account.pot_color || 'var(--purple-mid)'} strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                            <rect x=\"1\" y=\"4\" width=\"22\" height=\"16\" rx=\"2\" ry=\"2\" />\r\n                                            <line x1=\"1\" y1=\"10\" x2=\"23\" y2=\"10\" />\r\n                                        </svg>\r\n                                    </div>\r\n                                    <div className=\"pot-info\">\r\n                                        <div className=\"pot-name\">{account.account_name}</div>\r\n                                        <div className=\"pot-meta\">{typeLabels[account.account_type] || account.account_type} ¬∑ {account.owner || 'Joint'}</div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-sm\">\r\n                                        <div className=\"pot-amount\">\r\n                                            ¬£{account.current_balance.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                                        </div>\r\n                                        <button onClick={(e) => { e.stopPropagation(); handleDelete(account.id); }} className=\"icon-btn\" style={{ color: 'var(--error)', width: '32px', height: '32px' }}>\r\n                                            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" /><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n                                            </svg>\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                );\r\n            })}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2771, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/G/Desktop/SavinGCs/components/UpdateBalanceForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface Account {\r\n    id: number;\r\n    pot_id: number;\r\n    account_name: string;\r\n    account_type: string;\r\n    owner: string;\r\n    current_balance: number;\r\n    pot_name: string;\r\n    pot_color: string;\r\n}\r\n\r\ninterface UpdateBalanceFormProps {\r\n    onSuccess: () => void;\r\n    currentUser: { id: number; username: string; displayName: string };\r\n}\r\n\r\nexport default function UpdateBalanceForm({ onSuccess, currentUser }: UpdateBalanceFormProps) {\r\n    const [accounts, setAccounts] = useState<Account[]>([]);\r\n    const [balances, setBalances] = useState<Record<number, string>>({});\r\n    const [loading, setLoading] = useState(true);\r\n    const [saving, setSaving] = useState(false);\r\n    const [saved, setSaved] = useState<Set<number>>(new Set());\r\n\r\n    useEffect(() => { fetchAccounts(); }, []);\r\n\r\n    const fetchAccounts = async () => {\r\n        try {\r\n            const res = await fetch('/api/accounts');\r\n            const data = await res.json();\r\n            const accs = data.accounts || [];\r\n            setAccounts(accs);\r\n            // Pre-fill with current balances\r\n            const initial: Record<number, string> = {};\r\n            accs.forEach((a: Account) => { initial[a.id] = a.current_balance.toFixed(2); });\r\n            setBalances(initial);\r\n        } catch (error) {\r\n            console.error('Error fetching accounts:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleUpdateSingle = async (account: Account) => {\r\n        const newBalance = parseFloat(balances[account.id] || '0');\r\n        if (isNaN(newBalance)) return;\r\n\r\n        setSaving(true);\r\n        try {\r\n            // Update the account balance directly\r\n            const res = await fetch(`/api/accounts/${account.id}`, {\r\n                method: 'PATCH',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    accountName: account.account_name,\r\n                    accountType: account.account_type,\r\n                    currentBalance: newBalance,\r\n                })\r\n            });\r\n            if (!res.ok) throw new Error('Failed to update');\r\n\r\n            // Log the change as a transaction for history\r\n            const diff = newBalance - account.current_balance;\r\n            if (diff !== 0) {\r\n                await fetch('/api/transactions', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({\r\n                        accountId: account.id,\r\n                        userId: currentUser.id,\r\n                        amount: diff,\r\n                        description: `Balance update: ¬£${account.current_balance.toFixed(2)} ‚Üí ¬£${newBalance.toFixed(2)}`,\r\n                        transactionDate: new Date().toISOString().split('T')[0],\r\n                    })\r\n                });\r\n            }\r\n\r\n            setSaved((prev) => new Set(prev).add(account.id));\r\n            setTimeout(() => setSaved((prev) => { const next = new Set(prev); next.delete(account.id); return next; }), 2000);\r\n        } catch (error) {\r\n            console.error('Error updating balance:', error);\r\n            alert('Failed to update balance');\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const handleSaveAll = async () => {\r\n        setSaving(true);\r\n        for (const account of accounts) {\r\n            const newBalance = parseFloat(balances[account.id] || '0');\r\n            if (isNaN(newBalance) || newBalance === account.current_balance) continue;\r\n            await handleUpdateSingle(account);\r\n        }\r\n        setSaving(false);\r\n        onSuccess();\r\n    };\r\n\r\n    if (loading) return <div className=\"skeleton\" style={{ height: '200px' }} />;\r\n\r\n    // Group accounts by pot\r\n    const groupedByPot: Record<string, Account[]> = {};\r\n    accounts.forEach((acc) => {\r\n        if (!groupedByPot[acc.pot_name]) groupedByPot[acc.pot_name] = [];\r\n        groupedByPot[acc.pot_name].push(acc);\r\n    });\r\n\r\n    return (\r\n        <div>\r\n            <h2 style={{ marginBottom: 'var(--sp-xs)' }}>Update Balances</h2>\r\n            <p style={{ fontSize: '0.8rem', color: 'var(--text-tertiary)', marginBottom: 'var(--sp-lg)' }}>\r\n                Enter the current balance for each account. Changes are logged automatically.\r\n            </p>\r\n\r\n            {accounts.length === 0 ? (\r\n                <div className=\"empty-state\">\r\n                    <div className=\"empty-state-icon\">üè¶</div>\r\n                    <div className=\"empty-state-text\">No accounts yet. Add some in Settings first!</div>\r\n                </div>\r\n            ) : (\r\n                <>\r\n                    {Object.entries(groupedByPot).map(([potName, potAccounts]) => (\r\n                        <div key={potName} style={{ marginBottom: 'var(--sp-lg)' }}>\r\n                            <div style={{ fontSize: '0.7rem', fontWeight: 700, color: 'var(--text-tertiary)', textTransform: 'uppercase', letterSpacing: '0.08em', marginBottom: 'var(--sp-sm)', padding: '0 2px' }}>\r\n                                {potName}\r\n                            </div>\r\n                            <div className=\"stack\" style={{ gap: 'var(--sp-sm)' }}>\r\n                                {potAccounts.map((account) => (\r\n                                    <div key={account.id} className=\"card\" style={{ padding: 'var(--sp-md)' }}>\r\n                                        <div className=\"flex justify-between items-center mb-sm\">\r\n                                            <div>\r\n                                                <div style={{ fontWeight: 600, fontSize: '0.9rem' }}>{account.account_name}</div>\r\n                                                <div style={{ fontSize: '0.7rem', color: 'var(--text-tertiary)' }}>\r\n                                                    Current: ¬£{account.current_balance.toLocaleString('en-GB', { minimumFractionDigits: 2 })} ¬∑ {account.account_type} ¬∑ {account.owner || 'Joint'}\r\n                                                </div>\r\n                                            </div>\r\n                                            {saved.has(account.id) && (\r\n                                                <div style={{ fontSize: '0.75rem', color: 'var(--success)', fontWeight: 600, display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                                    <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                                        <polyline points=\"20 6 9 17 4 12\" />\r\n                                                    </svg>\r\n                                                    Saved\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                        <div className=\"flex gap-sm items-center\">\r\n                                            <div style={{ position: 'relative', flex: 1 }}>\r\n                                                <span style={{ position: 'absolute', left: '12px', top: '50%', transform: 'translateY(-50%)', color: 'var(--text-tertiary)', fontWeight: 600, fontSize: '1rem' }}>¬£</span>\r\n                                                <input\r\n                                                    type=\"number\"\r\n                                                    step=\"0.01\"\r\n                                                    className=\"form-input\"\r\n                                                    value={balances[account.id] || ''}\r\n                                                    onChange={(e) => setBalances({ ...balances, [account.id]: e.target.value })}\r\n                                                    style={{ paddingLeft: '28px', fontFamily: 'var(--font-mono)', fontWeight: 700, fontSize: '1.05rem' }}\r\n                                                />\r\n                                            </div>\r\n                                            <button\r\n                                                type=\"button\"\r\n                                                className=\"btn btn-teal\"\r\n                                                style={{ padding: '12px 16px', minHeight: 'auto', fontSize: '0.8rem' }}\r\n                                                onClick={() => handleUpdateSingle(account)}\r\n                                                disabled={saving || parseFloat(balances[account.id] || '0') === account.current_balance}\r\n                                            >\r\n                                                Save\r\n                                            </button>\r\n                                        </div>\r\n                                        {/* Show diff if changed */}\r\n                                        {parseFloat(balances[account.id] || '0') !== account.current_balance && (\r\n                                            <div style={{\r\n                                                fontSize: '0.75rem', marginTop: '6px', fontWeight: 600, fontFamily: 'var(--font-mono)',\r\n                                                color: parseFloat(balances[account.id] || '0') > account.current_balance ? 'var(--success)' : 'var(--error)'\r\n                                            }}>\r\n                                                {parseFloat(balances[account.id] || '0') > account.current_balance ? '+' : ''}\r\n                                                ¬£{(parseFloat(balances[account.id] || '0') - account.current_balance).toLocaleString('en-GB', { minimumFractionDigits: 2 })} change\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n\r\n                    <button className=\"btn btn-primary\" style={{ width: '100%', marginTop: 'var(--sp-md)' }} onClick={handleSaveAll} disabled={saving}>\r\n                        {saving ? 'Saving...' : 'Save All Changes'}\r\n                    </button>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3187, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/G/Desktop/SavinGCs/components/AccountDetail.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface BalanceHistoryEntry {\r\n    balance: number;\r\n    recorded_date: string;\r\n    created_at: string;\r\n}\r\n\r\ninterface AccountDetailProps {\r\n    accountId: number;\r\n    currentUser: { id: number; username: string; displayName: string };\r\n    onClose: () => void;\r\n    onUpdate: () => void;\r\n}\r\n\r\nexport default function AccountDetail({ accountId, currentUser, onClose, onUpdate }: AccountDetailProps) {\r\n    const [account, setAccount] = useState<any>(null);\r\n    const [history, setHistory] = useState<BalanceHistoryEntry[]>([]);\r\n    const [txCount, setTxCount] = useState(0);\r\n    const [loading, setLoading] = useState(true);\r\n    const [saving, setSaving] = useState(false);\r\n    const [saved, setSaved] = useState(false);\r\n    const [showWarning, setShowWarning] = useState(false);\r\n    const [pendingChanges, setPendingChanges] = useState<any>(null);\r\n\r\n    // Editable fields\r\n    const [balance, setBalance] = useState('');\r\n    const [accountType, setAccountType] = useState('');\r\n    const [owner, setOwner] = useState('');\r\n\r\n    useEffect(() => { fetchAccount(); }, [accountId]);\r\n\r\n    const fetchAccount = async () => {\r\n        try {\r\n            const res = await fetch(`/api/accounts/${accountId}`);\r\n            const data = await res.json();\r\n            if (!res.ok) throw new Error(data.error);\r\n            setAccount(data.account);\r\n            setHistory(data.history || []);\r\n            setTxCount(data.transactionCount || 0);\r\n            setBalance(data.account.current_balance.toFixed(2));\r\n            setAccountType(data.account.account_type);\r\n            setOwner(data.account.owner || 'Joint');\r\n        } catch (error) {\r\n            console.error('Error fetching account:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const hasMetadataChanges = () => {\r\n        if (!account) return false;\r\n        return accountType !== account.account_type || owner !== (account.owner || 'Joint');\r\n    };\r\n\r\n    const hasBalanceChange = () => {\r\n        if (!account) return false;\r\n        return parseFloat(balance) !== account.current_balance;\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        if (!account) return;\r\n\r\n        // If metadata changes exist and there's transaction history, show warning\r\n        if (hasMetadataChanges() && txCount > 0 && !showWarning) {\r\n            setPendingChanges({\r\n                accountName: account.account_name,\r\n                accountType,\r\n                owner,\r\n                currentBalance: parseFloat(balance),\r\n            });\r\n            setShowWarning(true);\r\n            return;\r\n        }\r\n\r\n        await performSave();\r\n    };\r\n\r\n    const performSave = async () => {\r\n        setSaving(true);\r\n        setShowWarning(false);\r\n\r\n        try {\r\n            const newBalance = parseFloat(balance);\r\n            const res = await fetch(`/api/accounts/${accountId}`, {\r\n                method: 'PATCH',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    accountName: account.account_name,\r\n                    accountType,\r\n                    owner,\r\n                    currentBalance: newBalance,\r\n                })\r\n            });\r\n\r\n            if (!res.ok) throw new Error('Failed to update');\r\n\r\n            // Log transaction for the balance change\r\n            const diff = newBalance - account.current_balance;\r\n            if (diff !== 0) {\r\n                await fetch('/api/transactions', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({\r\n                        accountId: account.id,\r\n                        userId: currentUser.id,\r\n                        amount: diff,\r\n                        description: `Balance update: ¬£${account.current_balance.toFixed(2)} ‚Üí ¬£${newBalance.toFixed(2)}`,\r\n                        transactionDate: new Date().toISOString().split('T')[0],\r\n                    })\r\n                });\r\n            }\r\n\r\n            setSaved(true);\r\n            setTimeout(() => { setSaved(false); onUpdate(); onClose(); }, 1200);\r\n        } catch (error) {\r\n            console.error('Error saving:', error);\r\n            alert('Failed to save changes');\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const balanceDiff = account ? parseFloat(balance) - account.current_balance : 0;\r\n    const today = new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });\r\n\r\n    if (loading) {\r\n        return (\r\n            <div>\r\n                <div className=\"skeleton\" style={{ height: '40px', marginBottom: '16px' }} />\r\n                <div className=\"skeleton\" style={{ height: '200px' }} />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!account) {\r\n        return <div className=\"empty-state\"><div className=\"empty-state-text\">Account not found</div></div>;\r\n    }\r\n\r\n    const typeLabels: Record<string, string> = {\r\n        savings: 'Savings', isa: 'ISA', current: 'Current', investment: 'Investment', other: 'Other'\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            {/* Header */}\r\n            <div style={{ marginBottom: 'var(--sp-lg)' }}>\r\n                <h2 style={{ marginBottom: '4px' }}>{account.account_name}</h2>\r\n                <div style={{ fontSize: '0.8rem', color: 'var(--text-tertiary)' }}>\r\n                    {account.pot_name} ¬∑ {typeLabels[account.account_type] || account.account_type} ¬∑ {account.owner || 'Joint'}\r\n                </div>\r\n                <div style={{ fontSize: '0.7rem', color: 'var(--text-tertiary)', marginTop: '4px' }}>\r\n                    Recording as at {today}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Current Balance Display */}\r\n            <div className=\"card\" style={{ padding: 'var(--sp-lg)', marginBottom: 'var(--sp-lg)', textAlign: 'center' }}>\r\n                <div style={{ fontSize: '0.7rem', fontWeight: 600, color: 'var(--text-tertiary)', textTransform: 'uppercase', letterSpacing: '0.08em', marginBottom: '6px' }}>\r\n                    Current Balance\r\n                </div>\r\n                <div style={{ fontFamily: 'var(--font-mono)', fontSize: '2rem', fontWeight: 700, color: 'var(--text-primary)' }}>\r\n                    ¬£{account.current_balance.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Update Balance */}\r\n            <div className=\"form-group\">\r\n                <label className=\"form-label\">New Balance (¬£)</label>\r\n                <div style={{ position: 'relative' }}>\r\n                    <span style={{ position: 'absolute', left: '14px', top: '50%', transform: 'translateY(-50%)', color: 'var(--text-tertiary)', fontWeight: 700, fontSize: '1.1rem' }}>¬£</span>\r\n                    <input\r\n                        type=\"number\"\r\n                        step=\"0.01\"\r\n                        className=\"form-input\"\r\n                        value={balance}\r\n                        onChange={(e) => setBalance(e.target.value)}\r\n                        style={{ paddingLeft: '30px', fontFamily: 'var(--font-mono)', fontWeight: 700, fontSize: '1.2rem' }}\r\n                    />\r\n                </div>\r\n                {balanceDiff !== 0 && !isNaN(balanceDiff) && (\r\n                    <div style={{\r\n                        fontSize: '0.8rem', marginTop: '6px', fontWeight: 700, fontFamily: 'var(--font-mono)',\r\n                        color: balanceDiff > 0 ? 'var(--success)' : 'var(--error)',\r\n                        display: 'flex', alignItems: 'center', gap: '4px',\r\n                    }}>\r\n                        {balanceDiff > 0 ? '‚Üë' : '‚Üì'} {balanceDiff > 0 ? '+' : ''}¬£{balanceDiff.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Account Type */}\r\n            <div className=\"form-group\">\r\n                <label className=\"form-label\">Account Type</label>\r\n                <select className=\"form-select\" value={accountType} onChange={(e) => setAccountType(e.target.value)}>\r\n                    <option value=\"savings\">Savings Account</option>\r\n                    <option value=\"isa\">ISA</option>\r\n                    <option value=\"current\">Current Account</option>\r\n                    <option value=\"investment\">Investment Account</option>\r\n                    <option value=\"other\">Other</option>\r\n                </select>\r\n            </div>\r\n\r\n            {/* Owner */}\r\n            <div className=\"form-group\">\r\n                <label className=\"form-label\">Owner</label>\r\n                <select className=\"form-select\" value={owner} onChange={(e) => setOwner(e.target.value)}>\r\n                    <option value=\"Gary\">Gary</option>\r\n                    <option value=\"Catherine\">Catherine</option>\r\n                    <option value=\"Joint\">Joint</option>\r\n                </select>\r\n            </div>\r\n\r\n            {/* Warning for metadata changes with existing history */}\r\n            {showWarning && (\r\n                <div style={{\r\n                    background: 'rgba(251, 191, 36, 0.1)',\r\n                    border: '1px solid rgba(251, 191, 36, 0.3)',\r\n                    borderRadius: 'var(--r-lg)',\r\n                    padding: 'var(--sp-md)',\r\n                    marginBottom: 'var(--sp-md)',\r\n                }}>\r\n                    <div style={{ display: 'flex', alignItems: 'flex-start', gap: 'var(--sp-sm)' }}>\r\n                        <span style={{ fontSize: '1.2rem', lineHeight: 1 }}>‚ö†Ô∏è</span>\r\n                        <div>\r\n                            <div style={{ fontWeight: 700, fontSize: '0.85rem', color: 'var(--warning)', marginBottom: '4px' }}>\r\n                                Changing account details\r\n                            </div>\r\n                            <div style={{ fontSize: '0.78rem', color: 'var(--text-secondary)', lineHeight: 1.5 }}>\r\n                                This account has <strong>{txCount} balance change{txCount !== 1 ? 's' : ''}</strong> in its history.\r\n                                Changing the type or owner won't affect historical records, but could make past entries misleading.\r\n                            </div>\r\n                            <div style={{ fontSize: '0.75rem', color: 'var(--text-tertiary)', marginTop: '6px', lineHeight: 1.5 }}>\r\n                                üí° <strong>Recommendation:</strong> If this is a fundamentally different account, consider deleting this one and creating a new account instead to keep your history clean.\r\n                            </div>\r\n                            <div style={{ display: 'flex', gap: 'var(--sp-sm)', marginTop: 'var(--sp-md)' }}>\r\n                                <button className=\"btn btn-secondary\" style={{ flex: 1, padding: '10px', minHeight: 'auto', fontSize: '0.8rem' }} onClick={() => setShowWarning(false)}>\r\n                                    Cancel\r\n                                </button>\r\n                                <button className=\"btn\" style={{\r\n                                    flex: 1, padding: '10px', minHeight: 'auto', fontSize: '0.8rem',\r\n                                    background: 'var(--warning)', color: '#000', fontWeight: 700,\r\n                                }} onClick={performSave}>\r\n                                    Save Anyway\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Save button */}\r\n            {!showWarning && (\r\n                <button\r\n                    className=\"btn btn-primary\"\r\n                    style={{ width: '100%', marginBottom: 'var(--sp-lg)' }}\r\n                    onClick={handleSave}\r\n                    disabled={saving || saved || (!hasBalanceChange() && !hasMetadataChanges())}\r\n                >\r\n                    {saved ? (\r\n                        <span style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '6px' }}>\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                <polyline points=\"20 6 9 17 4 12\" />\r\n                            </svg>\r\n                            Saved\r\n                        </span>\r\n                    ) : saving ? 'Saving...' : 'Save Changes'}\r\n                </button>\r\n            )}\r\n\r\n            {/* Balance History */}\r\n            {history.length > 0 && (\r\n                <div>\r\n                    <div className=\"section-header\" style={{ marginTop: 'var(--sp-md)' }}>\r\n                        <div className=\"section-title\" style={{ fontSize: '0.95rem' }}>Balance History</div>\r\n                        <div className=\"section-link\">{history.length} record{history.length !== 1 ? 's' : ''}</div>\r\n                    </div>\r\n                    <div className=\"stack\" style={{ gap: 'var(--sp-xs)' }}>\r\n                        {history.map((entry, i) => {\r\n                            const prevBalance = i < history.length - 1 ? history[i + 1].balance : null;\r\n                            const diff = prevBalance !== null ? entry.balance - prevBalance : null;\r\n                            return (\r\n                                <div key={i} style={{\r\n                                    display: 'flex', justifyContent: 'space-between', alignItems: 'center',\r\n                                    padding: 'var(--sp-sm) var(--sp-md)',\r\n                                    background: 'var(--bg-card)', borderRadius: 'var(--r-md)',\r\n                                    border: '1px solid var(--border)',\r\n                                }}>\r\n                                    <div>\r\n                                        <div style={{ fontSize: '0.8rem', color: 'var(--text-secondary)', fontWeight: 600 }}>\r\n                                            {new Date(entry.recorded_date).toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' })}\r\n                                        </div>\r\n                                        {diff !== null && (\r\n                                            <div style={{\r\n                                                fontSize: '0.7rem', fontFamily: 'var(--font-mono)', fontWeight: 600, marginTop: '2px',\r\n                                                color: diff >= 0 ? 'var(--success)' : 'var(--error)',\r\n                                            }}>\r\n                                                {diff >= 0 ? '+' : ''}¬£{diff.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                    <div style={{ fontFamily: 'var(--font-mono)', fontWeight: 700, fontSize: '0.9rem', color: 'var(--text-primary)' }}>\r\n                                        ¬£{entry.balance.toLocaleString('en-GB', { minimumFractionDigits: 2 })}\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4020, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/G/Desktop/SavinGCs/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Dashboard from '@/components/Dashboard';\nimport Login from '@/components/Login';\nimport SpreadsheetView from '@/components/SpreadsheetView';\nimport ManagePots from '@/components/ManagePots';\nimport ManageAccounts from '@/components/ManageAccounts';\nimport UpdateBalanceForm from '@/components/UpdateBalanceForm';\nimport AccountDetail from '@/components/AccountDetail';\n\nexport default function Home() {\n  const [user, setUser] = useState<any>(null);\n  const [currentView, setCurrentView] = useState<'home' | 'accounts' | 'history' | 'manage'>('home');\n  const [loading, setLoading] = useState(true);\n  const [showUpdateBalance, setShowUpdateBalance] = useState(false);\n  const [selectedAccountId, setSelectedAccountId] = useState<number | null>(null);\n  const [refreshKey, setRefreshKey] = useState(0);\n\n  useEffect(() => { checkSession(); }, []);\n\n  const checkSession = async () => {\n    try {\n      const res = await fetch('/api/auth/session');\n      if (res.ok) {\n        const data = await res.json();\n        if (data.authenticated) setUser(data.user);\n      }\n    } catch (error) {\n      console.error('Session check error:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleLogout = async () => {\n    await fetch('/api/auth/session', { method: 'POST' });\n    setUser(null);\n  };\n\n  const handleBalanceUpdated = () => {\n    setShowUpdateBalance(false);\n    setRefreshKey((prev) => prev + 1);\n  };\n\n  const handleAccountClick = (accountId: number) => {\n    setSelectedAccountId(accountId);\n  };\n\n  const handleAccountDetailClose = () => {\n    setSelectedAccountId(null);\n  };\n\n  const handleAccountUpdated = () => {\n    setRefreshKey((prev) => prev + 1);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"app-shell\" style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', minHeight: '100dvh' }}>\n        <div className=\"skeleton\" style={{ width: '280px', height: '380px' }} />\n      </div>\n    );\n  }\n\n  if (!user) return <Login onLogin={setUser} />;\n\n  return (\n    <div className=\"app-shell\">\n      {/* Header */}\n      <div className=\"app-header\">\n        <div className=\"header-user\">\n          <div className=\"avatar\">\n            {user.displayName?.charAt(0) || 'U'}\n          </div>\n          <div>\n            <div className=\"header-greeting\">Welcome back</div>\n            <div className=\"header-name\">{user.displayName}</div>\n          </div>\n        </div>\n        <div className=\"header-actions\">\n          <button className=\"icon-btn\" onClick={handleLogout} title=\"Logout\">\n            <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\" /><polyline points=\"16 17 21 12 16 7\" /><line x1=\"21\" y1=\"12\" x2=\"9\" y2=\"12\" />\n            </svg>\n          </button>\n        </div>\n      </div>\n\n      {/* Main content */}\n      <div className=\"app-content\">\n        {currentView === 'home' && <Dashboard key={refreshKey} onUpdateBalance={() => setShowUpdateBalance(true)} onAccountClick={handleAccountClick} />}\n        {currentView === 'accounts' && <ManageAccounts key={refreshKey} onUpdate={() => setRefreshKey((prev) => prev + 1)} onAccountClick={handleAccountClick} />}\n        {currentView === 'history' && <SpreadsheetView key={refreshKey} />}\n        {currentView === 'manage' && <ManagePots key={refreshKey} onUpdate={() => setRefreshKey((prev) => prev + 1)} />}\n      </div>\n\n      {/* Bottom Tab Bar */}\n      <nav className=\"tab-bar\">\n        <button className={`tab-item${currentView === 'home' ? ' active' : ''}`} onClick={() => setCurrentView('home')}>\n          <span className=\"tab-icon\">\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\" /><polyline points=\"9 22 9 12 15 12 15 22\" />\n            </svg>\n          </span>\n          Home\n        </button>\n\n        <button className={`tab-item${currentView === 'accounts' ? ' active' : ''}`} onClick={() => setCurrentView('accounts')}>\n          <span className=\"tab-icon\">\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <rect x=\"1\" y=\"4\" width=\"22\" height=\"16\" rx=\"2\" ry=\"2\" /><line x1=\"1\" y1=\"10\" x2=\"23\" y2=\"10\" />\n            </svg>\n          </span>\n          Accounts\n        </button>\n\n        {/* Center FAB ‚Äî Update Balance */}\n        <button className=\"tab-fab\" onClick={() => setShowUpdateBalance(true)} title=\"Update Balance\">\n          <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"23\" /><path d=\"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\" />\n          </svg>\n        </button>\n\n        <button className={`tab-item${currentView === 'history' ? ' active' : ''}`} onClick={() => setCurrentView('history')}>\n          <span className=\"tab-icon\">\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <circle cx=\"12\" cy=\"12\" r=\"10\" /><polyline points=\"12 6 12 12 16 14\" />\n            </svg>\n          </span>\n          History\n        </button>\n\n        <button className={`tab-item${currentView === 'manage' ? ' active' : ''}`} onClick={() => setCurrentView('manage')}>\n          <span className=\"tab-icon\">\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <circle cx=\"12\" cy=\"12\" r=\"3\" /><path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\n            </svg>\n          </span>\n          Settings\n        </button>\n      </nav>\n\n      {/* Update Balance Bottom Sheet */}\n      {showUpdateBalance && (\n        <div className=\"modal-overlay\" onClick={(e) => { if (e.target === e.currentTarget) setShowUpdateBalance(false); }}>\n          <div className=\"modal-sheet\">\n            <div className=\"modal-handle\" />\n            <UpdateBalanceForm onSuccess={handleBalanceUpdated} currentUser={user} />\n          </div>\n        </div>\n      )}\n\n      {/* Account Detail Bottom Sheet */}\n      {selectedAccountId !== null && (\n        <div className=\"modal-overlay\" onClick={(e) => { if (e.target === e.currentTarget) handleAccountDetailClose(); }}>\n          <div className=\"modal-sheet\">\n            <div className=\"modal-handle\" />\n            <AccountDetail\n              accountId={selectedAccountId}\n              currentUser={user}\n              onClose={handleAccountDetailClose}\n              onUpdate={handleAccountUpdated}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}